{"./":{"url":"./","title":"一、前言介绍","keywords":"","body":"国光的黑苹果安装教程：手把手教你配置 OpenCore Hackintosh 且行且珍惜 写这篇文章的时间是 2021 年 09 月 15 日，今天的苹果发布会暂时还没有下一代 Mac 的消息，如果下一代 Mac 不配备 intel CPU 的话，那么黑苹果这个技术会随着时间的流逝逐渐成功历史，为了证明自己来过，所以写了这个系列的黑苹果从 0 开始的教程。 实际上 OpenCore 官方文档写的已经很不错了，本教程的大部分内容也会搬运自 OpenCore 官方文档。 本 Gitbook 系列的原版文件开源项目地址为：https://github.com/sqlsec/Hackintosh Why Reinventing 轮子? 为什么要重复造轮子呢？国光我不是一个喜欢重复造轮子的人，而且这个工作量本身也很大，平时的工作任务本身就很有挑战性了，还得抽出时间写这个系列，这不是自讨苦吃吗。所以我想分享一下，写这个系列的 Gitbook 的几个原因： OpenCore 官方文档对小白不是很友好，也不符合国内的阅读习惯，阅读需要一定的门槛 OpenCore 黑苹果这块一直没有一个系统的教程，写这个系列日后还可以配合视频讲解在 B 站出一个教程系列 授人以鱼不如授人以渔，与其等待大佬们的 EFI，不如自己动手自己配置一个自己的 EFI 关于 Hackintosh 凡是存在即合理，黑苹果的英文 Hackintosh，里面出现了 Hack，说到 Hack 就不得不提 Hacker 的几个基本的精神：热爱、叛逆、共享、开源、免费...... 所以黑苹果本身也继承了这些特点，试想一下，如果著名的黑苹果 kexts 驱动：Liu、WhateverGreen、AppleALC 不开源的话，黑苹果技术还会和我们有关系吗？我们本质上就是一些 kexts 的搬运工，本身并没有创造什么，只是一些基本的排列组合。这也是国光我也坚持开源 EFI 的原因，毕竟喝水不忘挖井人。 好了，说了一堆乱七八糟的了，下面黑苹果教程正式开始。 一起完善 together 当然一个人的精力是有限的，疏漏难以避免，如果你发现错误或者遗留的话可以直接发我邮箱即可 admin@sqlsec.com 或者直接通过 Github 提交 PR 也是很欢迎的。 参考资料 Reference Dortania's OpenCore Install Guide [指南] hackintosh之SSDT/DSDT · Mac OS之程序员 · 看云 DSDT - ArchWiki 黑果小兵的部落阁 黑苹果星球-分享Mac的精彩世界 在这个喧嚣浮躁的时代，坚持写博客输出原创文章的人还有多少呢？写博客感觉一直是用爱发电的状态...... 如果你恰巧财力雄厚，感觉本文对你有所帮助的话，可以考虑打赏一下本文，用以维持高昂的服务器运营费用（域名费用、服务器费用、CDN 费用等） 微信 支付宝 国光我也写了一个打赏页面用以感谢支持我的朋友，详情请看 打赏列表 | 国光 powered by Gitbook该文章最后修改时间： 2021-09-21 16:50:52 "},"1-基础知识/":{"url":"1-基础知识/","title":"二、基础知识","keywords":"","body":"二、基础知识 黑苹果安装的一些基础知识点，主要包括如下内容： 1. 基操勿六 2. 硬件限制 3. 寻找硬件 4. 专业术语 powered by Gitbook该文章最后修改时间： 2021-09-19 21:04:36 "},"1-基础知识/1-1.html":{"url":"1-基础知识/1-1.html","title":"1. 基操勿六","keywords":"","body":"1. 基操勿六 基础知识就是默认大家都懂的，如果不懂得话建议补一下基础再看此教程。 时间、稳定、版权 如果有项目要截止的话，请不要开始看这篇教程，因为刚开始黑苹果的过程基本上不会一帆风顺的，随便走一点弯路都是极其耗费时间的事情，另外注意休息，黑苹果的过程不差你熬夜的那几个小时。 如果你对系统要求追求稳定的话，也尽量不要使用黑苹果，虽然黑苹果完美度已经无限接近白苹果了，但是毕竟还是有个“黑”字，安装的时候要注意重要资料备份。 如果你的公司是正版化普及的公司（一般是 BAT 等大型公司），也不要使用黑苹果接入公司的网络，这样可能会收到苹果的律师函（树大招风），严格来说黑苹果属于 Hack 行为，侵犯了苹果公司的版权。 准备工作 一个满足黑苹果硬件限制的电脑和一个至少 16GB 的 U 盘，虽然目前来看 16GB 完全足够了，但是这几年苹果的镜像体积越拉越大，国光曾经在刻录一个 3 分区的镜像的时候，居然提示了 U 盘空间不足的情况。 另外，U 盘速度越快越好，可以极大的缩短黑苹果安装 U 盘的制作和系统安装的时间。 基本操作 首先安装黑苹果前得保证自己可以熟练安装 Windows 或者 Linux 系统（加分项），因为黑苹果安装需要磁盘满足一定要求，所以重新删除分区安装系统是常有的事情，如果你不会安装 Windows 不会熟练使用 PE 系统的话，建议去学习这些基本技能后再来学习黑苹果安装。 powered by Gitbook该文章最后修改时间： 2021-09-19 21:04:36 "},"1-基础知识/1-2.html":{"url":"1-基础知识/1-2.html","title":"2. 硬件限制","keywords":"","body":"2. 硬件限制 黑苹果的硬件和白苹果越接近约好，这样黑起来才比较顺利，最后的完成度也比较高。 CPU 支持 桌面 CPU 以你的 CPU 代号架构为准，后面的例子仅供参考，CPU 型号混乱，所以并不完整。 CPU 代号 中文名 for example Penryn ？？？ 太老了 我也太懒了 不写了 Yonah 尤娜？ 太老了 我也太懒了 不写了 Conroe ？？？ 太老了 我也太懒了 不写了 Merom ？？？ 太老了 我也太懒了 不写了 Penryn ？？？ 太老了 我也太懒了 不写了 Lynnfield ？？？ 太老了 我也太懒了 不写了 Clarkdale ？？？ 太老了 我也太懒了 不写了 Sandy Bridge 桑迪桥 2 代酷睿 Ivy Bridge ？？？ 3 代酷睿 Haswell 哈斯威尔 4 代酷睿 Broadwell 布罗德韦尔 5 代酷睿 SkyLake 天空湖 6 代酷睿 Kaby Lake 卡比湖 7 代酷睿 Coffee Lake 咖啡湖 8、9 代酷睿 Comet Lake 彗星湖 10 代酷睿 笔记本 CPU 以你的 CPU 代号架构为准，后面的例子仅供参考，CPU 型号混乱，所以并不完整。 CPU 代号 中文名 for example Clarksfield ？？？ 太老了 我也太懒了 不写了 Arrandale ？？？ 太老了 我也太懒了 不写了 Sandy Bridge 桑迪桥 2 代酷睿 Ivy Bridge ？？？ 3 代酷睿 Haswell 哈斯威尔 4 代酷睿 Broadwell 布罗德韦尔 5 代酷睿 SkyLake 天空湖 6 代酷睿 Kaby Lake 卡比湖 7 代酷睿 Whiskey Lake 威士忌湖 8 代酷睿 Coffee Lake 咖啡湖 8、9 代酷睿 Comet Lake 彗星湖 10 代酷睿 Ice Lake 冰湖 10 代酷睿 i5-1035G4、i7-1065G7... 高端桌面 CPU 以你的 CPU 代号架构为准，后面的例子仅供参考，CPU 型号混乱，所以并不完整。 CPU 代号 中文名 for example Nehalem ？？？ 太老了 我也太懒了 不写了 Westmere ？？？ 太老了 我也太懒了 不写了 Sandy Bridge-E 桑迪桥 i7-3960X、i7-3960K、i7-3820K Ivy Bridge-E ？？？ i7-4960X、i7-4960K、i7-4820K Haswell-E 哈斯威尔 i7 5960X、i7 5820K、i7 5930K Broadwell-E 布罗德韦尔 i7-6950X、i7-6900K、i7-6850K、i7-6800K Skylake-X/W 天空湖 i7-7800X、i7-9800X、Xeon W-2104 Cascade Lake-X/W 级联湖 Xeon Gold 6142M AMD CPU 以你的 CPU 代号架构为准，后面的例子仅供参考，CPU 型号混乱，所以并不完整。 CPU 代号 中文名 for example Bulldozer(15h) 推土机 FX-41X0、FX-6XX0、FX-81X0 Jaguar(16h) 美洲豹 太老了 我也太懒了 不写了 Ryzen 锐龙 比较著名的架构 Threadripper(17h and 19h) 线程撕裂者 1950X、2990WX、3990X、3995WX GPU 支持 显卡这块也比较杂，难以列的很全，建议买之前先确定你的型号显卡有成功的案例再进行购买。显卡驱动情况大体上可以参考如下： AMD 的 GPU 支持情况： AMD 的 APU 系列目前无法驱动 AMD 的独显从 GCN 架构开始后面驱动情况都还不错 Intel 的 GPU 支持情况： macOS 不支持 Pentium、Celeron 和 Atom 上的低端 GT1 iGPU 绝大多数的 intel 核显都可以很好的驱动 理论上最强的核显是 i7-1065G7、其次是 lris 锐矩系列、接着是 UHD、HD 系列 NVIDIA 的 GPU 支持情况： Maxwell 麦克斯韦（9XX）和 Pascal 帕斯卡（10XX）系列最高只能安装到 macOS 10.13 High Sierra Turing 图灵（20XX, 16XX）目前无解 Ampere 安培 （30XX）目前无解 Keler （6XX，7XX）目前支持最新版本的 macOS，这是因为 MBP 历史上配备过这个显卡 GPU 型号也太杂了，这些也不在本教程范围类，OpenCore 官方总结的已经很详细了，大家可以参考： GPU Buyers Guide- 显卡购买指南 主板支持 绝大多数的主板都可以驱动 硬盘支持 在大多数情况下，支持所有基于 SATA 的硬盘以及大多数 NVMe 硬盘，但是也有少数比较坑的型号： 三星 PM981、PM991 和美光 2200S NVMe SSD 英特尔 600p 这些型号尽管后面使用 NVMeFix.kext 可以修复内核恐慌，但是依然可能会有一些小毛病，新手的话还是建议换硬盘，不建议碰这些型号。 有线网卡 几乎所有有线网络适配器在 macOS 中都有某种形式的支持，通过内置驱动程序或社区制作的 kexts。主但是也有一些棘手的型号： 英特尔 I225 2.5Gb 网卡 高端桌面 Comet Lake 主板可能配备 可能的解决方法：来源和例子 Intel I350 1Gb 服务器网卡 在各代 Intel 和 Supermicro 服务器主板上可能配备 解决方法 Intel 10Gb 服务器网卡 X520 和 X540 芯片组可能的变通方法 Mellanox 和 Qlogic 服务器网卡 无线网卡 大多数笔记本电脑附带的无线网卡不受支持，因为它们通常是 Intel/Qualcomm。如果幸运的话，您可能有一张受支持的 Atheros 卡，但支持最多只能达到 High Sierra。 最好的选择是获得受支持的 Broadcom 博通卡；可以参考 WiFi 购买者指南 后续国内的大佬 zxystd 移植开源了 intel 的网卡驱动也可以解决大多数 intel 网卡的驱动问题，虽然目前暂时无法使用隔空投送 AirDrop 但是已经进步很大了： intel 网卡可驱动的型号列表 声卡支持 声卡主要依赖 AppleALC 开源 kexts 来驱动，可以启用原生的 macOS 高清音频。 黑苹果声卡的驱动情况表以及 layouts id 情况 其他硬件 指纹传感器 目前无法模拟 Touch ID 传感器，因此指纹传感器基本上无解 Windows Hello 人脸识别 某些笔记本电脑带有 I2C 连接的 WHFR（并通过您的 iGPU 使用），这些将无法正常工作。 一些笔记本电脑带有 USB 连接的 WHFR，如果幸运的话，您可能会获得相机功能，但没有其他功能。 英特尔智能声音技术 配备英特尔 SST 的笔记本电脑不会通过它们（通常是内部麦克风）工作连接任何东西，因为它不受支持。您可以使用 Windows 上的设备管理器进行检查。 耳机麦克风一体接口组合 某些带有组合耳机麦克风接口的笔记本电脑可能无法通过它们获得音频输入，而必须使用内置麦克风或通过 USB 的外部音频输入设备。 雷电接口 雷电接口比较难搞和玄学，OC 官方建议主板禁用掉雷电口，但是不代表无解只是难搞 powered by Gitbook该文章最后修改时间： 2021-09-19 21:04:36 "},"1-基础知识/1-3.html":{"url":"1-基础知识/1-3.html","title":"3. 寻找硬件","keywords":"","body":"3. 寻找硬件 上文中大家差不多清楚了硬件的驱动情况，本篇中就分享一下如果判断确定自己的硬件型号的方法和技巧。 使用 Windows 查看硬件 CPU 型号 可以使用 Windows 自带的设备管理器或者自带的任务管理等，或者使用第三方的软件：CPU-Z、AIDA64、鲁大师等 GPU 型号 可以使用 Windows 自带的设备管理器或者自带的任务管理等，或者使用第三方的软件：GPU-Z、AIDA64、鲁大师等 芯片组型号 设备管理器： 或者使用 AIDA64 这类第三方软件： 声卡型号 建议使用 AIDA64、鲁大师等第三方软件： 网卡型号 设备管理器或者 AIDA64，还是建议使用第三方的软件查看： 硬盘型号 硬盘的话通过软件一般看不到详细的信息，只能自己配合谷歌去确认 一下： 键盘、触控板、触控屏连接类型 遗憾的是，AIDA64 没有提供有这类设备的任何有用信息，因此我们建议为此使用设备管理器。 您可以在以下位置找到这些设备： Human Interface Devices 人体学接口设备(HID) Keyboards 键盘 Mice and other Pointer Devices 鼠标和其他指针设备 要查看设备的确切连接类型，请选择指针设备，然后输入View -> Device by Connection。这样比较直观地展示它是否通过 PS2、I2C、SMBus、USB 等连接情况 根据设备的不同，它可能会显示在多个名称和连接下。主要关注以下几点： SMBus 一般这种触控板的驱动支持比较友好，手势也很完美，在设备管理器中将显示为一条直线PCI设备，如Synaptics SMBus Driver或ELAN SMBus Driver USB 这些将显示为一个PS2 Compliant Trackpad，以及在USB当我们切换我们的连接视图Device by Connection I2C 这些几乎总是显示为 Microsoft HID 设备，但也可以显示为其他触控板。不过，它们将始终显示在 I2C 下。 使用 Linux 查看硬件 为了使用 Linux 查找硬件，我们将使用如下命令： pciutils dmidecode 大多数 Linux 发行版都已经安装了这些工具。如果没有，您可能会在发行版的包管理器中找到它们。 # CPU型号 grep -i \"model name\" /proc/cpuinfo # 显卡型号 lspci | grep -i --color \"vga\\|3d\\|2d\" # 芯片组型号 dmidecode -t baseboard # 声卡型号 aplay -l # 网卡型号 lspci | grep -i network lshw -class networ # 硬盘型号 lshw -class disk -class storage # 键盘、触控板、触控屏连接类型 dmesg | grep -i input powered by Gitbook该文章最后修改时间： 2021-09-19 21:04:36 "},"1-基础知识/1-4.html":{"url":"1-基础知识/1-4.html","title":"4. 专业术语","keywords":"","body":"4. 专业术语 基础名词 名词 描述 Hackintosh 将 macOS 安装到非苹果官方 PC 的过程，请注意Hackintosh 不是操作系统 Bootloader 加载操作系统的软件，通常由操作系统创建者制作 Boot Manager 管理引导加载程序的软件比如：Clover、OpenCore 等 Clover 被 OpenCore 逐步替代的一个引导方式 OpenCore 由Acidanthera 团队在打造的 Hackintosh 新的更完美的引导方式 ACPI 高级配置和电源接口 ，可以让系统更好的识别硬件信息 DSDT/SSDT ACPI 中的表格，描述设备以及操作系统应如何与它们交互 .AML ACPI 的编译文件格式 .DSL ACPI 的源代码文件 Kexts 全程叫 Kernel Extensions 内核扩展，我们国内可以通俗的翻译为驱动 BIOS 基本输出输入系统，可以通俗的理解为主板的操作系统 UEFI 统一可扩展固件接口，可以让 PC 从预启动的操作环境，加载到操作系统上 UEFI 驱动 与任何其他操作系统一样，UEFI 具有驱动程序，它们由 Clover 或 OpenCore 加载 NVRAM 非易失性随机访问存储器，主板自带的，UEFI 启动的时候会先加载 NVRM ACPI 相关 名词 描述 EC 嵌入式控制器。在主板和嵌入式外围设备（如热键、端口或电池）之间进行通信 PLUG 允许连接 XCPM、Apple XNU 电源管理，以实现更好的整体 CPU 控制 AWAC ACPI Wake Alarm Counter Clock，板的内部时钟，Hackintosh 必须对其进行修补 PMC 电源管理控制器，部分主板需要 SSDT-PMC 来进行修补 PNLF 内部背光显示，macOS 使用此 PNLF 设备发送和接收信息以进行亮度控制 XOSI/_OSI _OSI 用于确定正在启动的操作系统，重命名为 XOSI 允许我们欺骗硬件 HPET 高精度事件定时器，macOS 对设备的设置方式非常挑剔，因此我们有时需要修补 HPET RHUB 根 USB 集线器，其中定义了 USB 端口。 IMEI 英特尔管理引擎接口，处理杂项任务。macOS 依靠 IMEI 来实现 Intel GPU 加速 UNC Uncore Bridge，类似于北桥，它处理许多与缓存相关的功能 SMBS 系统管理总线，用于允许设备之间轻松通信。 UEFI 引导磁盘结构划分 UEFI 相关的概念 UEFI 是 Unified Extensible Firmware Interface（统一可扩展固件接口），可以让 PC 从预启动的操作环境，加载到操作系统上。大家可以理解为 UEFI 是一种系统引导方式，基本上 2010 年后的电脑都是支持 UEFI 引导方式的。 UEFI 引导常配合 GPT 分区表来使用，在 DiskGenius 中，选中磁盘，右键选【转换分区表类型为 GUID 格式】即可将磁盘转换为 GPT 分区表。 EFI 分区是 UEFI 引导必备的一个分区，在磁盘当中的名称一般叫做 ESP 分区，它大多位于磁盘的第 1 个分区，格式可以是 FAT16 也可以是 FAT32 格式，主要用来保存引导文件。安装黑苹果的话，要注意 ESP 的分区得大于 200MB，国光我建议设置为 300MB 基本上足够使用了。 单个硬盘安装单独的 macOS 值得一说的是，这种情况压根不需要我们手动创建 EFI 分区，直接安装的时候选择整个想要安装的磁盘即可，macOS 会自动创建磁盘分区的： 单个硬盘安装 Windows 和 macOS 这个一个 512GB SSD 双系统磁盘划分的情况： C 盘为未来会用作 Windows 的 C 盘，123 GB 一般也足够日常轻度使用了 D 盘到时候用来安装 macOS，353 GB 日常使用也足够了实际上 E 盘这个盘符是临时划分的，实际上他就是 ESP 引导分区，未来 Windows 和 macOS 的引导都会放这里 powered by Gitbook该文章最后修改时间： 2021-09-21 15:12:36 "},"2-启动盘制作/":{"url":"2-启动盘制作/","title":"三、U盘制作","keywords":"","body":"三、启动盘制作 黑苹果安装 U 盘制作的一些知识点，主要包括如下内容： 1. 下载镜像 2. 写入镜像 3. 结构讲解 powered by Gitbook该文章最后修改时间： 2021-09-19 21:04:36 "},"2-启动盘制作/2-1.html":{"url":"2-启动盘制作/2-1.html","title":"1. 下载镜像","keywords":"","body":"1. 下载镜像 我们国内黑苹果小兵前辈会经常更新一些懒人镜像，这些镜像很适合小白使用。 大家可以去前辈的博客去下载就行了，双分区、三分区的都是可以的。 如果大家想下载苹果官方的镜像，自己制作的话（不适合小白）可以直接参考 OC 官方文档，国光我就不搬运了，直接贴了地址： Creating the USB | OpenCore Install Guide powered by Gitbook该文章最后修改时间： 2021-09-19 21:04:36 "},"2-启动盘制作/2-2.html":{"url":"2-启动盘制作/2-2.html","title":"2. 写入镜像","keywords":"","body":"2. 写入镜像 写入镜像实际上也有很多工具，国光这里推荐一个后来居上的工具 balenaEthcher 官方支持 Windows、macOS、Linux 的版本，下载即可使用。下面简单说下安装制作镜像的方法： 这个软件使用也比较简单，就是上图标记的三步，是不是很简单呢？ 由于国光我手上的这个 U 盘是固态改的，所以几分钟时间就写入完成了，写入成功后的提示信息如下： powered by Gitbook该文章最后修改时间： 2021-09-19 21:04:36 "},"2-启动盘制作/2-3.html":{"url":"2-启动盘制作/2-3.html","title":"3. 结构讲解","keywords":"","body":"3. 结构讲解 黑苹果 U 盘制作完成了，下面来大概讲解一下目前 U 盘的结构划分情况，以及作用是啥，话不多说直接看图： macOS 下使用 Hackintool 可以直观的看到磁盘的结构信息： 如果是 Windows 的话，使用经典的磁盘工具 DiskGenius 也是可以看到的。下面来给大家一一展示下这 3 个分区里面放着哪些内容。 挂载 EFI 绝大多数的情况下 EFI 分区默认是隐藏的，我们在 Hackintool 工具下「右键」选择「装载」输入密码后即可挂载 EFI 分区： 挂载 EFI 分区后，桌面上的三个分区就全部显示出来了： EFI 默认 EFI 分区下的文件内容如下： 小兵前辈还放了 2 个 app，我们可以选择性保留。 默认的 EFI 文件夹是 Clover 配套的，所以后续我们需要删掉整个 EFI 文件夹，然后讲 OC 的 EFI 拷贝进来。 WEPE 默认 WEPE 分区下的文件内容如下： 这个分区我们一般不用管，虽然这里也有 EFI 文件夹，但是这个是引导 Windows PE 使用的，了解一下就行。 Install macOS Big Sur Install macOS Big Sur 分区下面就躺着苹果官方的系统安装包了，这个实际上是 .app 结尾的格式，苹果的应用基本上都是这个格式，实际上我们后续安装黑苹果成功之后，也可以去 AppStore 里面手动下载这个镜像： 至此，启动盘初步就制作好了，接下来就是我们配置好一个适合我们机型的 EFI 驱动配置文件的事情了，配置好 EFI 直接放入到 U 盘 EFI 分区下即可。 powered by Gitbook该文章最后修改时间： 2021-09-19 21:04:36 "},"3-准备工作/":{"url":"3-准备工作/","title":" 四、准备工作","keywords":"","body":"四、准备工作 配置 OC 的一些前戏，主要包括如下内容： 1. BIOS设置 2. OC 文件结构 3. 准备 ACPI 4. 准备 Kexts 5. Drivers说明 6. OC 编辑器 7. 初步配置 8. Kexts 微调 powered by Gitbook该文章最后修改时间： 2021-09-19 23:10:59 "},"3-准备工作/3-1.html":{"url":"3-准备工作/3-1.html","title":"1. BIOS设置","keywords":"","body":"1. BIOS设置 以下 BIOS 设置尽量参考一下，因为主板型号凌乱的原因，找不全也是很正常的，尽量靠齐这些设置就行。 Intel 主板 BIOS 设置 关闭 - Disable Fast Boot 快速启动 Secure Boot 安全启动 Serial/COM Port 串行通讯端口 Parallel Port 并行端口 VT-d Intel® Virtualization Technology for Directed I/O (VT-d) 的缩写，I/O 的虚拟化技术 如果找不到的话，配置里面设置 DisableIoMapper 选项为 YES 也是 OK 的 CSM 容性支持模块 Thunderbolt 雷电，安装的时候雷电口没有关容易引发一些玄学问题，建议关掉省事儿 Intel SGX 也叫做 Software Guard Extensions，是Intel 推出的一种基于 CPU 硬件的安全保障机制 Intel Platform Trust 英特尔平台可信技术，主要用于密钥管理（密钥的加密及存储）和安全认证服务 CFG Lock MSR 0xE2 写保护 必须关闭，如果找不到的话，配置里面设置 AppleXcpmCfgLock 选项为 YES 也是 OK 的 开启 - Enable VT-x intel 运用 Virtualization 虚拟化技术中的一个指令集，是CPU的硬件虚拟化技术 Above 4G decoding 4G 以上解码 Hyper-Threading 超线程技术 Execute Disable Bit Intel 新一代处理器的功能，主要做病毒防护使用 DVMT Pre-Allocated: 64MB 分配给DVMT所需要内存大小 EHCI/XHCI Hand-off EHCI/XHCI 切换 OS type: Windows 8.1/10 UEFI Mode 操作系统类型 SATA Mode: AHCI SATA 磁盘启动模式 AMD 主板 BIOS 设置 关闭 - Disable Fast Boot 快速启动 Secure Boot 安全启动 Serial/COM Port 串行通讯端口 Parallel Port 并行端口 Compatibility Support Module (CSM) 容性支持模块，必须关闭 开启 - Enable Above 4G decoding 4G 以上解码 必须打开，如果主板找不到的话，就在 boot-args 启动参数添加 npci=0x2000 也是 OK 的 EHCI/XHCI Hand-off EHCI/XHCI 切换 OS type: Windows 8.1/10 UEFI Mode 操作系统类型 SATA Mode: AHCI SATA 磁盘启动模式 部分主板的参考案例 华擎 AsRock Z490 Steel Legend 钢铁传奇 「高级」-「CPU 配置」-「Intel Hyper Threading Technology」-「开启」 「高级」-「CPU 配置」-「CFG Lock」-「关闭」 「高级」-「CPU 配置」-「Software Guard Extensions（SGX）」-「关闭」 「高级」-「芯片组配置」-「Above 4G Decoding」-「启用」 「高级」-「芯片组配置」-「VT-d」-「禁用」 「高级」-「芯片组配置」-「共享内存」-「64MB」 「高级」-「芯片组配置」-「IGPUA 多监视器」-「启用」 「高级」-「芯片组配置」-「深度睡眠」-「在 S4-S5 中启用」 「高级」-「存储 配置」-「SATA 模式选择」-「AHCI」 「高级」-「Intel(R) Thunderbolt」-「Discrete Thunderbolt(TM) Support」-「关闭」 「高级」-「ACPI 配置」-「挂起到内存」-「自动」 「高级」-「ACPI 配置」-「USB 键盘/远程开机」-「Disabled」 「高级」-「ACPI 配置」-「USB 鼠标开机」-「Disabled」 「高级」-「USB 配置」-「XHCI Hand-off」-「Enabled」 「安全」-「Secure Boot」-「安全引导」-「关闭」 「安全」-「Intel(R) Platform Trust Technology」-「禁用」 「引导」-「闪速启动」-「关闭」 「引导」-「CSM」-「关闭」 驰为 CoreBook X 14 「Advanced」-「Software Guard Extensions（SGX）」-「Disabled」 「Advanced」-「Hyper-Threading」-「Enabled」 「Advanced」-「ACPI Settings」-「Enable Hibernation」-「Enabled」 「Advanced」-「USB Configuration」-「Legacy USB Support」-「Enabled」 「Advanced」-「XHCI Hand-off」-「Enabled」 「Advanced」-「CSM Configuration」-「CSM Support」-「Disabled」 「Chipset」-「Type C Support」-「Platform-POR」 「Chipset」-「System Agent (SA) Configuration」-「VT-d」-「Disabled」 「Chipset」-「Above 4GB MMID BIOS assignment」-「Enabled」 「Chipset」-「Graphics Configuration」-「DVMT Pre-Allocated」-「64MB」 「Chipset」-「PCH-IO Configuration」-「SATA Mode Selection」-「AHCI」 「Security」-「Security Boot」-「Security Boot」-「Disabled」 「Boot」-「Quiet Boot」-「Enabled」 「Boot」-「Fast Boot」-「Disabled」 技嘉 GIGABYTE B360M AORUS PRO 【BIOS 功能】-【Windows 8/10】-【其他操作系统】 【BIOS 功能】-【CSM 支持】-【关闭】 【BIOS 功能】-【安全模式】-【Secure Boot Enable】-【关闭】 【集成外设】-【预设启动的显示设备】-【IGFX】（这里用的核显） 【集成外设】-【Intel Platform Trust Technology (PTT)】-【关闭】 【集成外设】-【Software Guard Extension (SGX)】-【关闭】 【集成外设】-【Trusted Computing】-【Security Device Support】-【Disable】 【集成外设】-【Super IO 配置】-【Serial Port】-【关闭】 【集成外设】-【USB 程序】-【Legacy USB Support】-【开启】 【集成外设】-【集成外设】-【XHCI Hand-off】-【开启】 【集成外设】-【集成外设】-【USB Mass Storege Driver Support】-【开启】 【集成外设】-【Network Stack Configuration】-【Network Stack】-【关闭】 【集成外设】-【SATA And RST Configuration】-【SATA Mode Selection】-【AHCI】 【芯片组】-【VT-d】-【关闭】 【芯片组】-【Internal Graphics】-【启动】 【芯片组】-【DVMT Pre-Allocated】-【64M】 【芯片组】-【DVMT Total Gfx Mem】-【256M】 【芯片组】-【4G 以上解码】-【启动】 【芯片组】-【Wake on LAN Enable】-【关闭】 【电源管理】-【平台电力管理】-【关闭】 【电源管理】-【鼠标唤醒】-【双击】 powered by Gitbook该文章最后修改时间： 2021-09-21 14:59:23 "},"3-准备工作/3-2.html":{"url":"3-准备工作/3-2.html","title":"2. OC 文件结构","keywords":"","body":"2. OC 文件结构 原始文件结构 OpenCore 引导的官方项目地址为：https://github.com/acidanthera/OpenCorePkg 查看最新版本的下载地址为：https://github.com/acidanthera/OpenCorePkg/releases 截止写文章的时间 2021 年 09 月 17 日，最新的 OC 引导为 0.7.3 的版本，所以我们下载 OpenCore-0.7.3-RELEASE.zip 并解压，这样就得到 OC 的最原始的文件了。 下面分别大概说明一下这些目录的作用： Docs：存放 OC 最新的配置文档、版本更新变化、ACPI 示例文件以及 Sample.list 配置文件模板 IA32：里面放着 32 位老机器使用的 EFI 引导文件 Utilities：OC 官方集成的小工具都放在这里 X64： 里面放着 64 位目前主流机器使用的 EFI 引导文件 知道了大概的目录结果的话，下面来详细的介绍一下这些目录里面的文件详细情况。 Docs ~/Downloads/OpenCore-0.7.3-RELEASE/Docs . ├── AcpiSamples # ACPI 示例文件 │ ├── Binaries # 编译好的 ACPI 文件 │ │ ├── SSDT-ALS0.aml │ │ ├── SSDT-AWAC-DISABLE.aml │ │ ... │ └── Source # ACPI 原始文件 │ ├── SSDT-ALS0.dsl │ ├── SSDT-AWAC-DISABLE.dsl │ ... ├── Changelog.md # 版本更新日志 ├── Configuration.pdf # 当期版本的官方配置文档 ├── Differences.pdf # 和上一个版本的改变部分 ├── Sample.plist # 当期版本的配置文件模板 └── SampleCustom.plist # 当期版本的配置文件模板 这里面文件都比较好理解，除了发现貌似 2 个配置文件模板，分别是 Sample.plist 和 SampleCustom.plist，但是国光我对比了一下，发现二者基本上没有差别，理论上都是可使用的，我们普遍使用 Sample.plist 这个配置文件比较多。 Utilities 这个目录下放着一些 OC 官方的小工具，下面来分别介绍一下这些小工具的作用 acdtinfo：检测当前机器的 kexts 安装情况 ACPIe：产生有用的 ACPI 查找跟踪排错使用 CreateVault：里面包含了 RSA 秘钥生成工具和用来创建 Valut 的脚本 disklabel：标签生成小工具，一般也用不到 icnspack：icns 合成制作小工具，想要自己自定义主题的时候可以用得上 kpdescribe：调式 Debug 排错使用，用于恢复堆栈跟踪 LegacyBoot：在旧电脑中模拟 UEFI 环境的工具和脚本 LogoutHook：用于模拟 NVRAM 保存的增强脚本 macrecovery：启动盘制作脚本 macserial：序列号生成工具 ocpasswordgen：OpenCore 密码数据生成工具 ocvalidate：检测 config.list 语法的正确与否 EFI 最后来到了我们的重头戏 EFI 部分，下面是 EFI 主要文件夹的作用讲解： ~/Downloads/OpenCore-0.7.3-RELEASE/X64/EFI . ├── BOOT # 引导文件夹 │ └── BOOTx64.efi # 引导文件 └── OC # OC 文件夹 ├── ACPI # ACPI 存放的文件夹 │ ├── SSDT-EC.aml │ ├── SSDT-PLUG.aml │ │── SSDT-PNLF.aml │ ... ├── Drivers # OC 驱动的文件夹 │ ├── AudioDxe.efi │ ├── CrScreenshotDxe.efi │ ├── HiiDatabase.efi │ ... ├── Kexts # 存放内核拓展 kexts 的文件夹 │ ├── AppleALC.kext │ ├── Lilu.kext │ ├── WhateverGreen.kext │ ... ├── OpenCore.efi # OC 的核心文件 ├── Resources # OC 的主题样式 │ ├── Audio │ ├── Font │ ├── Image │ └── Label └── Tools # OC 小工具文件夹 ├── BootKicker.efi ├── ChipTune.efi ├── CleanNvram.efi ... BOOT BOOT 引导文件夹，下面躺着 BOOTx64.ef 引导文件 OC/ACPI 下面存放这 SSDT 编译好的文件，格式均为 .aml 格式，关于 SSDT 详细的说明可以参考下面的章节 OC/Drivers 这里放着一些驱动文件，这些驱动均已 .efi 后缀结尾，OC 官方默认的驱动文件以及说明如下： AudioDxe.efi：用与启动的时候播放 Duang 的声音，就像白苹果那样 CrScreenshotDxe.efi：OC 引导界面截图驱动，按 F10 会保存当前界面的截图到 EFI 分区的根目录下 HiiDatabase.efi：用于支持 UEFI 字体渲染，四代酷睿后一般不需要 NvmExpressDxe.efi：用于让老主板支持 NVME Express 设备，四代酷睿后一般不需要 OpenCanopy.efi：使用图形化 OC 主题必备驱动 OpenHfsPlus.efi：文件系统驱动，用于支持识别 HFS+ 的磁盘格式 OpenLinuxBoot.efi：OC 0.7.3 新增的驱动，用于引导 Linux 系统 OpenPartitionDxe.efi：分区管理驱动程序。用于加载旧版 macOS 的 DMG 映像 OpenRuntime.efi：OC 核心必备驱动，功能比较强大，大家记住这个是必备的驱动就行 OpenUsbKbDxe.efi：USB 键盘驱动，用于模拟苹果热键，是 KeySupport 的等效方案 Ps2KeyboardDxe.efi：PS/2 键盘驱动，这个 PS/2 键盘也太老了吧，我好多年没见过了 Ps2MouseDxe.efi：PS/2 鼠标驱动，同样也太老了，很多年没有见过了 UsbMouseDxe.efi：USB 鼠标驱动，有些虚拟机需要依赖改驱动才可以在引导界面使用鼠标 XhciDxe.efi：XHCI USB controller 驱动程序，基本上 2 代酷睿开始大多数固件都自带这个驱动程序了 OC/Kexts 这里放着一些 Kexts 内核扩展文件，格式均为 .kext 文件，关于 Kexts 详细的说明可以参考下面的章节 Resources 这里放着 OC 的第三方主题文件，实际上国光我一直用的官方主题，就挺简约的。 Tools OC 小工具文件夹，像下面的 CleanNvram.efi 和 ResetSystem.efi 就是其中的一些小工具： OC 官方自带的工具文件以及说明如下： BootKicker.efi：调用苹果原生的引导切换 GUI, 给白苹果使用的，黑苹果不支持 ChipTune.efi：测试 BeepGen 协议并生成不同风格和长度的音频信号。 CleanNvram.efi：NVRAM 清理工具，实际上 OC 自带的 NVRAM 清理功能已经足够了 ControlMsrE2.efi：检查所有内核的CFG 锁定（MSR 0xE2写保护）一致性，并在更改此类隐藏选项 CsrUtil.efi：简单实现苹果csrutil的 SIP 相关功能 GopStop.efi：停止显卡 GOP，排错时使用用一个简单的场景测试 GraphicsOutput 协议 KeyTester.efi：在 SimpleText 模式下测试键盘输入。 MmapDump.efi：ProvideCustomSlide 选项的必要性 OpenControl.efi：为其他工具提供 NVRAM 保护，以便在从 OC 启动时能够获得完整的 NVRAM 访问权限。 OpenShell.efi：OpenCore 配置的 UEFI Shell ResetSystem.efi：用于执行系统重置的实用程序 RtcRw.efi：用于读取和写入 RTC (CMOS) 存储器的实用程序。 TpmInfo.efi：检查平台上的英特尔 PTT（平台信任技术）功能，如果启用，则允许使用 fTPM 2.0 好了，至此 OpenCore 的文件结构就介绍的差不多了，下面开始学习下 ACPI 的相关知识。 powered by Gitbook该文章最后修改时间： 2021-09-19 21:04:36 "},"3-准备工作/3-3.html":{"url":"3-准备工作/3-3.html","title":"3. 准备 ACPI","keywords":"","body":"3. 准备 ACPI 基本概念 APCI 高级配置与电源接口（Advanced Configuration and Power Interface），是 1997 年由英特尔、微软、东芝共同提出、制定的操作系统电源管理、硬件配置接口，ACPI 定义了系统固件 BIOS 或 UEFI 和操作系统之间的硬件抽象接口。 它帮助操作系统合理控制和分配计算机硬件设备的电量，有 了 ACPI ，操作系统可以根据设备实际情况，根据需要把不同的硬件设备关闭。 它主要涵盖的功能包括： System power management（系统电源管理） Device power management（设备电源管理） Processor power management（处理器电源管理） Device and processor performance management（设备及处理器性能管理） Configuration / Plug and Play（配置/即插即用） System Events（系统事件） Battery management（电池管理） Thermal management（温度管理） Embedded Controller（嵌入式控制器） SMBus Controller（SMBus控制器） 在计算机应用平台，ACPI 越来越重要。ACPI 由很多表组成，包括：RSDP，SDTH，RSDT，FADT，FACS，DSDT，SSDT，MADT，SBST，XSDT，ECDT，SLIT，SRAT。其中 DSDT 就是它的一个重要的描述表。 DSDT 、SSDT 正如上面所说，DSDT 和 SSDT 是 ACPI 规范的一部分，概述了硬件设备，如 USB 控制器、CPU 线程、嵌入式控制器、系统时钟等。 DSDT（差分系统描述表）可以被视为包含大部分信息的主体 SSDT（辅助系统描述表）传递的信息较少 可以将 DSDT 视为建筑蓝图，其中 SSDT 是概述项目额外细节的便签 Why？为什么要知道这些 macOS 可能对 DSDT 中存在的设备非常挑剔，因此我们需要纠正它。macOS 正常工作需要修正的主要设备： EC 嵌入式控制器 非苹果的机型都在其 DSDT 中公开了一个 EC，但是通常与 macOS 不兼容，可能会导致恐慌，因此需要对 macOS 隐藏。 对于笔记本电脑，实际的嵌入式控制器仍然需要启用电池和热键才能工作，并且重命名 EC 还会导致 Windows 出现问题，因此最好在不禁用真正的嵌入式控制器的情况下创建假 EC。 Plugin type 插件类型 允许使用 XCPM 在 Intel Haswell 以及更新架构的 CPU上提供本地 CPU 电源管理，这个不适合 AMD AWAC system clock AWAC 系统时钟 因为 macOS 无法与 AWAC 时钟通信，因此这要求我们要么强制使用传统 RTC 时钟，要么在不可用的情况下为 macOS 创建一个假的时钟来玩 NVRAM SSDT 真正的 300 系列主板（非 Z370）不会在 ACPI 中将 FW 芯片声明为 MMIO，因此内核会忽略 UEFI 内存映射声明的 MMIO 区域。这个 SSDT 带回了 NVRAM 支持 Backlight SSDT 用于修复笔记本电脑上的背光控制支持 GPIO SSDT 用于允许 VoodooI2C 连接，仅适用于笔记本电脑 XOSI SSDT 用于将 OSI 调用重新路由到此 SSDT，主要用于诱使我们的硬件认为其启动 Windows，以便我们获得更好的触控板支持 IRQ SSDT and ACPI patches 用于修复 DSDT 中的 IRQ 冲突，主要用于笔记本电脑。SSDT Time 独占 注意 Skylake 和较新的 CPU 很少有 IRQ 冲突，这主要在 Broadwell 和较旧的系统上使用 常见 ACPI 组合 ACPI 可以自己手动编译，也可以下载别人编译好的，虽然自己编译是最完美的，但是需要一定的学习门槛，所以小白用户还是建议下载编译好的 SSDT 文件即可。 下面可以根据自己的机型，参考下文，下载属于自己的 ACPI 文件即可。 Intel 桌面 Penryn、Younah、Conroe SSDT-EC-DESKTOP.aml Lynnfield、Clarkdale SSDT-EC-DESKTOP.aml SandyBridge、Ivy Bridge CPU-PM.aml 电源管理使用 需要自己脚本生成，比较老了，可以参考 Sandy and Ivy Bridge Power Management 生成后需要配合 ACPI 补丁：Delete CpuPm、Delete Cpu0Ist SSDT-EC-DESKTOP.aml SSDT-IMEI.aml 修复 Ivy Bridge CPU 与 6 系列主板混合的问题 修复 Sandy Bridge CPU 与 7 系列主板混合的问题 Hasewell、Broadwell SSDT-PLUG-DRTNIA.aml SSDT-EC-DESKTOP.aml Skylake SSDT-PLUG-DRTNIA.aml SSDT-EC-USBX-DESKTOP.aml Kaby Lake SSDT-PLUG-DRTNIA.aml SSDT-EC-USBX-DESKTOP.aml Coffee Lake SSDT-PLUG-DRTNIA.aml SSDT-EC-USBX-DESKTOP.aml SSDT-AWAC.aml 修复较新硬件上的系统时钟 支持以下主板： B360、B365、H310、H370 Z370（具有较新 BIOS 版本的 Gigabyte 和 AsRock 主板） Z390 B460、Z490 400系列 （Comet Lake） 495系列 （Ice lake） Comet Lake SSDT-PLUG-DRTNIA.aml SSDT-EC-USBX-DESKTOP.aml SSDT-AWAC.aml 修复较新硬件上的系统时钟 支持以下主板： B360、B365、H310、H370 Z370（具有较新 BIOS 版本的 Gigabyte 和 AsRock 主板） Z390 B460、Z490 400系列 （Comet Lake） 495系列 （Ice lake） SSDT-RHUB.aml 修复某些 OEM主板的问题，需要关闭 RHUB 设备并强制 macOS 手动重建端口 华硕 Z490 需要这个 SSDT 微星主板有待测试 技嘉和华擎主板工作很好，不需要这个 SSDT Intel 笔记本 Clarksfield、Arrandale SSDT-EC-LAPTOP.aml SSDT-XOSI.aml 触控板连接修复 需要配合 ACPI 补丁：Change _OSI to XOSI 来使用 NUC 不需要这个 SSDT-PNLF.aml 修复笔记本亮度控制，NUC 不需要这个 Sany Bridge、Ivy Bridge CPU-PM.aml 电源管理使用 需要自己脚本生成，比较老了，可以参考 Sandy and Ivy Bridge Power Management 生成后需要配合 ACPI 补丁：Delete CpuPm、Delete Cpu0Ist SSDT-EC-LAPTOP.aml SSDT-XOSI.aml 触控板连接修复 需要配合 ACPI 补丁：Change _OSI to XOSI 来使用 NUC 不需要这个 SSDT-PNLF.aml 修复笔记本亮度控制，NUC 不需要这个 SSDT-IMEI.aml 修复 Ivy Bridge CPU 与 6 系列主板混合的问题 修复 Sandy Bridge CPU 与 7 系列主板混合的问题 Haswell、Broadwell SSDT-PLUG-DRTNIA.aml SSDT-EC-LAPTOP.aml SSDT-XOSI.aml 触控板连接修复 需要配合 ACPI 补丁：Change _OSI to XOSI 来使用 NUC 不需要这个 如果这个不成功的话，可手动使用 MaciASL 编译 SSDT-GPI0.dsl.zip 来替代 XOSI SSDT-PNLF.aml 修复笔记本亮度控制，NUC 不需要这个 Skylake、Kaby Lake SSDT-PLUG-DRTNIA.aml SSDT-EC-USBX-LAPTOP.aml SSDT-XOSI.aml 触控板连接修复 需要配合 ACPI 补丁：Change _OSI to XOSI 来使用 NUC 不需要这个 如果这个不成功的话，可手动使用 MaciASL 编译 SSDT-GPI0.dsl.zip 来替代 XOSI SSDT-PNLF.aml 修复笔记本亮度控制，NUC 不需要这个 Coffee Lake、Whiskey Lake SSDT-PLUG-DRTNIA.aml SSDT-EC-USBX-LAPTOP.aml SSDT-XOSI.aml 触控板连接修复 需要配合 ACPI 补丁：Change _OSI to XOSI 来使用 NUC 不需要这个 如果这个不成功的话，可手动使用 MaciASL 编译 SSDT-GPI0.dsl.zip 来替代 XOSI SSDT-PNLF-CFL.aml SSDT-AWAC.aml 修复较新硬件上的系统时钟 支持以下主板： B360、B365、H310、H370 Z370（具有较新 BIOS 版本的 Gigabyte 和 AsRock 主板） Z390 B460、Z490 400系列 （Comet Lake） 495系列 （Ice lake） Coffee Lake Plus、Comet Lake SSDT-PLUG-DRTNIA.aml SSDT-EC-USBX-LAPTOP.aml SSDT-XOSI.aml 触控板连接修复 需要配合 ACPI 补丁：Change _OSI to XOSI 来使用 NUC 不需要这个 如果这个不成功的话，可手动使用 MaciASL 编译 SSDT-GPI0.dsl.zip 来替代 XOSI SSDT-PNLF-CFL.aml SSDT-AWAC.aml 修复较新硬件上的系统时钟 支持以下主板： B360、B365、H310、H370 Z370（具有较新 BIOS 版本的 Gigabyte 和 AsRock 主板） Z390 B460、Z490 400系列 （Comet Lake） 495系列 （Ice lake） SSDT-PMC.aml 用来支持适配 NVRAM 300 系列主板都需要此 SSDT（Z370除外） 支持以下主板： B360、B365 H310、H370（HM370 应该不需要这个） Z390 Intel 高端桌面 Nehalem、Westmere SSDT-EC-DESKTOP.aml Sandy Bridge-E、Ivy Bridge-E SSDT-EC-DESKTOP.aml SSDT-UNC.aml 禁用 ACPI 中未使用的设备，确保 IOPCIFamily 不会出现内核恐慌 所有的 X99 主板和大多数 X79 主板需要这个 SSDT 此外还有一些 C602、C612 主板也需要这个 SSDT Haswell-E、Broadwell-E SSDT-PLUG-DRTNIA.aml SSDT-EC-USBX-DESKTOP.aml SSDT-RTC0-RANGE-HEDT.aml Big Sur 需要确保 RTC 设备的兼容 SSDT-UNC.aml 禁用 ACPI 中未使用的设备，确保 IOPCIFamily 不会出现内核恐慌 所有的 X99 主板和大多数 X79 主板需要这个 SSDT 此外还有一些 C602、C612 主板也需要这个 SSDT Skylake-X/W、Cascade Lake-X/W SSDT-PLUG-DRTNIA.aml SSDT-EC-USBX-DESKTOP.aml SSDT-RTC0-RANGE-HEDT.aml Big Sur 需要确保 RTC 设备的兼容 AMD 桌面 Bulldozer(15h)、Jaguar(16h) SSDT-EC-USBX-DESKTOP.aml Ryzen、Threadripper(17h and 19h) SSDT-EC-USBX-DESKTOP.aml SSDT-CPUR.aml 用于 B550 和 A520 主板修复 CPU 定义，其他主板可以不使用 X570 和较旧的主板不需要此 SSDT 黑苹果 ACPI 大全? 由于 ACPI 太多了，国光我不可能都列的很全，而且有些 SSDT 作用网上没有权威解释，所以下面的解释说明也会有误差，仅做参考使用，如果内容方面有所遗漏或者发现严重错误的话，欢迎 Github 提交 PR 补充： 序号 SSDT 文件名 解释说明 1 FixShutdown-USB-SSDT.aml 修复 USB 控制器，解决睡眠或者关机自动重启 2 Spoof-SSDT.aml 禁用 GPU 3 SSDT-ALS0.aml 添加虚拟的环境光传感器以在重启后保存之前亮度设置 4 SSDT-ARTC.aml 修复在较新的硬件上找到的系统时钟。OCC 自带的 5 SSDT-AWAC.aml 300 系列主板使用， 6 SSDT-BAT.aml ThinkPad 等型号的电池补丁 7 SSDT-BKey.aml 早期的亮度调节使用 8 SSDT-BRG0.aml BIOS 没有 Serial(COM) Port 串口或者找不到禁用 Super IO 的话可能需要 9 SSDT-CPUR.aml 能源管理，针对 AMD B550 和 A520 主板，X570 等较旧的主板不要使用 10 SSDT-EC-DESKTOP.aml 老的桌面平台使用，用于修复嵌入式控制器 11 SSDT-EC-LAPTOP.aml 老的笔记本平台使用，用于修复嵌入式控制器 12 SSDT-EC-USBX-DESKTOP.aml 新的桌面平台使用，用于修复嵌入式控制器 13 SSDT-EC-USBX-LAPTOP.aml 新的笔记本平台使用，用于修复嵌入式控制器 14 SSDT-EHCx_OFF.aml USB 兼容性表，禁用EHC1和EHC2。OCC 自带的 15 SSDT-EHCx-DISABLE.aml 不清楚具体作用 在其他人的 EFI 里面看到过 16 SSDT-GPI0.aml 触控板连接修复。OCC 也自带的 17 SSDT-GPRW.aml 修复睡眠自动唤醒补丁 18 SSDT-HPET.aml 主要用于 X79、X99 和笔记本电脑用户的 IRQ 补丁 19 SSDT-HV-CPU.aml 对 macOS 的 Hyper-V 集成支持 20 SSDT-HV-PLUG.aml 对 macOS 的 Hyper-V 集成支持 21 SSDT-HV-VMBUS.aml 对 macOS 的 Hyper-V 集成支持 22 SSDT-IMEI-S.aml 当 DSDT 中没有 IMEI 设备需要通过设备属性设置定义设备 ID 的时候才需要 23 SSDT-IMEI.aml 当 DSDT 中没有 IMEI 设备需要通过设备属性设置定义设备 ID 的时候才需要 24 SSDT-IRQ.aml 修复 IRQ 冲突 25 SSDT-LANC.aml 修复睡眠自动唤醒补丁 26 SSDT-LIDpatch.aml 合盖睡眠 27 SSDT-NDGP.aml 屏蔽独显 28 SSDT-OLARILA.aml 作用不详 来自于 Olaria.com 的特殊 SSDT 29 SSDT-OPT.aml 不清楚具体作用 在其他人的 EFI 里面看到过 30 SSDT-PLUG_FX.aml 可能是 AMD FX 系列专用的 CPU 能源管理 31 SSDT-PLUG_RYZEN.aml 可能是 AMD Ryzen 系列专用的 CPU 能源管理 32 SSDT-PLUG-DRTNIA.aml 用于 Hasewell 和更新 CPU 的能源管理 33 SSDT-PMC.aml 300 系列主板原生的 NVRAM 补丁 34 SSDT-PNLF-CFL.aml Coffee Lake 和更新平台的笔记本背光修复补丁 35 SSDT-PNLF.aml 大多数主板的背光修复补丁 36 SSDT-PTSWAK.aml 修复关机、睡眠问题 37 SSDT-RHUB.aml 修复某些 400 系列主板的问题，需要关闭 RHUB 设备并强制 macOS 手动重建端口 38 SSDT-RTC0-RANGE-HEDT.aml 高端桌面平台专用，因为Big Sur 需要确保 RTC 设备的兼容 39 SSDT-SBUS-MCHC.aml 修复 SMBus 支持，解决 温度、风扇、电压等读数问题 40 SSDT-SHC0.aml 不清楚具体作用 在其他人的 EFI 里面看到过 41 SSDT-ThinkPad_ClickPad ThinkPad 的 ClickPad 专用 42 SSDT-UNC.aml 禁用 ACPI 中未使用的设备，确保 IOPCIFamily 不会出现内核恐慌 43 SSDT-UPRW.aml 修复睡眠自动唤醒补丁 44 SSDT-USB-Reset.aml 可能和 SSDT-RHUB 作用相同 45 SSDT-USBX.aml 不清楚具体作用 在其他人的 EFI 里面看到过 46 SSDT-XHC2.aml 自动注入 XHC 属性？ 47 SSDT-XOSI.aml 触控板连接修复，模拟 Windows 版本的 Darwin，需要配合补丁 powered by Gitbook该文章最后修改时间： 2021-09-19 21:04:36 "},"3-准备工作/3-4.html":{"url":"3-准备工作/3-4.html","title":"4. 准备 Kexts","keywords":"","body":"4. 准备 Kexts 基本概念 Kext 的英文全称叫做 Kernel Extension，即内核扩展，我们可以通俗的理解为这个就是 macOS 的驱动，使用方法只需要将这些 kext 文件放入到 EFI/OC/kexts 文件夹下面，然后编辑 OC 配置文件加载这些 kexts 并调节好顺序即可。 下载 Kexts 下面国光来简单列举一些下载 Kexts 的方法： 使用 OpenCore Configurator 这类第三方 OC 编辑器软件下载 搜索引擎搜索 Kexts 的Github 下面地址，手动去 Releases 里面寻找编译好的 kext 文件 使用 OC 官方的下载页面来下载常见的 kexts：https://dortania.github.io/builds/ Kexts 的分类 必备驱动 必备的 kexts 如果缺失的话，你的黑苹果系统就无法启动了 VirtualSMC.kext 模拟白苹果的 SMC 芯片 替代古老的 FakeSMC 只支持 OS X 10.6+ 版本的系统 Lilu.kext 很多著名 kexts 的依赖，没有 Liu 就无法正常使用 AppleALC、WhateverGreen、VirtualSMC 等 只支持 OS X 10.8+ 版本的系统 VirualSMC 插件 大家下载好 VirtualSMC 编译好的 kexts 的话，会发现里面还躺着其他的 kexts，这些其他的 kexts 就是 VirtualSMC 的插件了，下面来列举说明一下这些插件的作用： SMCBatteryManager.kext 笔记本专用，用于正确读取显示电池容量 SMCDellSensors.kext 某些 Dell 机器专用，一般不是 Dell 的机器不需要使用 对支持 SMM（系统管理模式）的 Dell 机器的风扇进行更准确的监视和控制 SMCLightSensor.kext 笔记本专用，用于笔记本电脑上的环境光感应器 大多都的笔记本都没有这个感应器，所以就算用了也只是伪感光 SMCProcessor.kext 用于监控 CPU 温度，台式机和笔记本都适用 不支持 AMD 的 CPU SMCSuperIO.kext 用于监控风扇的转速，台式机和笔记本都适用 不支持 AMD 的 CPU 显卡驱动 WhateverGreen.kext 基本上所有的核显和独显都要使用这个 kext 用于图形修补、DRM 修复、缓冲区修复等 只支持 OS X 10.8+ 版本的系统 声卡驱动 AppleALC.kext 用于 AppleHDA 修补，支持大多数的板载声卡驱动 文件夹下的 AppleALCU.kext 是 AppleALC 的精简版，仅支持数字音频 AMD 的主板和 CPU 可能会遇到一些问题，很少可以驱动麦克风 只支持 OS X 10.8+ 版本的系统 VoodooHDA.kext 比较古老且经典的声卡驱动，也叫万能声卡驱动 如果 AppeALC.kext 无法驱动话可以考虑这个 但是使用体验完美度肯定不如原生的 AppleALC.kext 的 只支持 OS X 10.6+ 版本的系统 USB 驱动 USBInjectAll.kext RehabMan 康复者之前的 USB 驱动 18 年 11 月发布的 0.7.1 是最后应该版本，后面再没有更新过 用于在 ACPI 中没有定义 USB 端口的系统上注入 Intel USB 控制器 Skylake+ 的桌面CPU 不需要这个 AsRock 华擎主板的话可能还是需要这个 Coffee Lake 貌似也还是需要这个 Skykak 之前的 CPU 理论上也是需要 支持 OS X 10.11+ 版本的系统 写到这里的时候感慨万千，RehabMan 可以说是黑苹果届的元老了，他也是 Tonymacx86 的一位版主，很多著名的黑苹果 kexts 都出自于他的手里，但是因为种种原因 18 年之后就再也没有活跃了，销声匿迹仿佛这个人没有来过一样，但是江湖上依然还有他的传说：Can we all thank RehabMan 我真的是太佩服这种人了，十年如一日的在论坛里面解答问题，定期更新这开源的 kexts，甚至有些 Apple 苹果开发者都来像他学习。黑苹果比较讽刺的是，伸手党没有感恩之心的人太多了，也许他安装系统遇到困难的时候就去你的 Github 下面提交 issue 催着你更新，就好像你开源这个驱动就要为他负责到底一样；安装成功之后呢，提问的人也就消失了，甚至连句谢谢都没有说，更不会留下任何有价值的文档信息之类的。这样就会导致很多大佬们每天千篇一律的回答各种重复的毫无技术含量的问题，如果是国光我的话，我肯定坚持不了几天的，但是 RehabMan 坚持了 10 余年，这真的是太令人震撼了。RehabMan 在 TonymacX86 的最后一个帖子说道：“我还在，但忙于其他（现实生活）的事情。将无法回答这里的问题。人是需要学习阅读的。” 但愿，希望真的如此，而不是被这些没有感恩之心的人伤透了心。 USBInjectAll.kext 国内黑苹果小兵大佬维护的版本 在 RehabMan 基础性更新完善的版本，目前到了 0.7.7 版本 支持后面新的 400、500 系列主板的支持 说到黑苹果小兵，国光我也很佩服这样的人，初次接触认识他的时候，我还以为是一个 30 多岁的中年人，结果后面才知道他的儿子已经上大学了，而且他也快到了退休的年龄。 黑果小兵也像 RehabMan 一样，写了很多黑苹果教程文章，也开源了很多机型的驱动，而且常年来一直坚持提供黑苹果懒人镜像的下载包，最关键的是都快退休的年龄了，还坚持做黑苹果这个比较“时髦”的技术，真的厉害了，不知道国光我老的时候，还可以坚持做这些吗？哈哈~ 如果黑苹果技术还存在的话。 有线网卡驱动 AtherosE2200Ethernet.kext Atheros 高通和 Killer 杀手 网卡 需要 注意：Atheros Killer E2500 型号实际上是基于 Realtek 的，所以请使用 RealtekRTL8111 驱动 支持 OS X 10.8+ 版本的系统 IntelMausi.kext 大多数 Intel 因特尔的网卡驱动 基于 I211 的芯片组的网卡需要使用 SmallTreeIntel82576 kext 官方支持 Intel 的 82578、82579、I217、I218 和 I219 网卡 详细支持驱动的有线网卡型号可以参考：https://github.com/acidanthera/IntelMausi 需要 OS X 10.9 或更新版本，10.6-10.8 的老用户可以使用 IntelSnowMausi 替代 LucyRTL8125Ethernet.kext Realtek 的 2.5Gb 的网卡驱动 官方这个页面需要注册才可以下载，也可以下载国光我上传蓝奏云的版本 需要 macOS 10.15+ 版本的系统 RealtekRTL8111.kext 大多数 Realtek 的千兆网卡驱动 注意：有时最新版本的 kext 可能无法正常工作，这个时候可以尝试使用旧版本。 SmallTreeIntel82576.kext I211 有线网卡驱动 大多数配备 intel 有线网卡的 AMD 主板需要 版本支持情况 OS X 10.9-12(v1.0.6)、macOS 10.13-14(v1.2.5)、macOS 10.15+(v1.3.0) 其他不需要 kext 的有线网卡 Intel I225-V 某些高端的 Comet Lake 主板会配备这个 I225-V 2.5GBe 有线网卡 OC 配置文件的设备属性里面添加 PciRoot(0x0)/Pci(0x1C,0x1)/Pci(0x0,0x0) 内容如下： device-id F2150000 类型为 DATA 类型 如果上面添加后遇到 AppleIntelI210Ethernet kext 内核报错的话，那么可以换成以下路径： PciRoot(0x0)/Pci(0x1C,0x4)/Pci(0x0,0x0) 需要 macOS 10.15 或更高版本 Intel I350 OC 配置文件的设备属性里面添加 PciRoot(0x0)/Pci(0x1,0x1)/Pci(0x0,0x0) 内容如下： device-id 33150000 类型为 DATA 类型 需要 OS X 10.10 或更新版本 一些比较古老的百兆有线网卡驱动 AppleIntelE1000e.kext 主要与基于 10/100MBe 的 Intel 有线网卡相关 需要 10.6 或更高版本 RealtekRTL8100.kext 支持的网卡型号有 RTL8101E、RTL8102E、RTL8103E、RTL8401E、RTL8105E、RTL8402、RTL8106E、RTL8106EUS、RTL8107E 官方这个页面需要注册才可以下载，也可以下载国光我上传蓝奏云的版本 BCM5722D.kext Broadcom 的有线网卡驱动 支持的网卡型号有 BCM5722、BCM5754、BCM5754M、BCM5755、BCM5755M、BCM57788、BCM5787、BCM5787M、BCM5906、BCM5906M 需要 OS X 10.6 或更新版本 无线网卡驱动 intel 无线网卡系列 国内 zxystd 大佬从 Linux OpenBSD 移植的驱动，非常硬核，完成度很高，接力也都可以正常使用，隔空投送目前只能识别，暂时还无法传输文件，不过已经很厉害了。 AirportItlwm.kext Intel 网卡的 WiFi 驱动 支持驱动的 intel 无线网卡型号表：https://docs.oiw.workers.dev/itlwm/Compat.html 只支持 macOS 10.13 以及更高的版本 IntelBluetoothFirmware.kext 与 IntelBluetoothFirmware.kext Intel 网卡的蓝牙驱动，与 AirportItlwm.kext 搭配使用 只支持 macOS 10.13 以及更高的版本 如果确定你的网卡型号支持驱动，但是蓝牙无法使用，那么多半是你的 USB 没有定制好 Broadcom 博通免驱系列 免驱网卡型号众多，可以参考 OC 官方的无线网卡购买指南 AirportBrcmFixup.kext 非苹果原装无线网卡或者非 Fenvi 奋威的博通网卡的无线网卡驱动 支持 OS X 10.10 以及更高的版本 Big Sur 后面的系统可能有些问题，可以参考官方的解决方案 BrcmPatchRAM 系列 所有非 Apple/非 Fenvi 无线网卡的蓝牙驱动 BrcmPatchRAM.kext 10.8-10.10 系统使用 BrcmPatchRAM2.kext 10.11-10.14 系统使用 BrcmPatchRAM3.kext 10.15+的系统使用 博通网卡的几个细节，Big Sur 以及后面的系统由于驱动有点异常，需要手动删除 AirPortBrcm4360_Injector.kext 蓝牙加载需要一定顺序，下面是 10.15+ 系统的蓝牙加载顺序 `Kernel -> Add `： BrcmBluetoothInjector.kext BrcmFirmwareData.kext BrcmPatchRAM3.kext 其他驱动 CpuTscSync.kext 在某些 Intel 的 HEDT 和服务器主板上同步 TSC 需要,如果没有这个 macOS 可能会非常慢甚至无法启动。 不适用于 AMD CPU 需要 OS X 10.8 或更新版本 为具有MSR_IA32_TSC_ADJUST(03Bh) 的CPU 添加了 macOS 12 兼容性 NVMeFix.kext 用于修复非 Apple 苹果的 NVMe 上的电源管理和初始化 需要 macOS 10.14 或更高版本 HibernationFixup.kext 一个旨在修复休眠兼容性问题的 Lilu 插件 解决黑苹果系统睡眠后无法唤醒、死机、黑屏的问题 SATA-unsupported.kext 笔记本电脑 在 macOS 中无法看到 SATA 硬盘驱动器的话，可以考虑使用 CtlnaAHCIPort.kext 一般在 Big Sur 下笔记本电脑 在 macOS 中无法看到 SATA 硬盘驱动器的话，可以考虑使用 AMD 常用驱动 AMDRyzenCPUPowerManagement.kext AMD 处理器的电源管理驱动 SMCAMDProcessor.kext AMD 处理器的传感器监控和 VirtualSMC 插件 AppleMCEReporterDisabler.kext 用于关闭 AppleMCERReport AppleMCERReport会导致AMD CPU的内核崩溃 某些双 CPU 的主板可能也有帮助 受影响的 SMBIOS 为：MacPro6,1、MacPro7,1、iMacPro1,1 需要 macOS 10.15 或更高版本 XLNCUSBFix.kext AMD FX 系统的 USB 修复，不推荐用于 Ryzen 需要 macOS 10.13 或更高版本 VoodooHDA.kext FX 系统的音频和 Ryzen 系统的前面板麦克风和外放的支持 请勿与 AppleALC 混合使用 比较古老且经典的声卡驱动，也叫万能声卡驱动 如果 AppeALC.kext 无法驱动话可以考虑这个 但是使用体验完美度肯定不如原生的 AppleALC.kext 的 只支持 OS X 10.6+ 版本的系统 笔记本专用驱动 输入设备驱动 VoodooPS2Controller.kext 适用于配备 PS2 键盘、鼠标和触控板的系统 MT2 (Magic Trackpad 2) 功能需要 macOS 10.11 或更新版本 RehabMan 的 VoodooPS2Controller.kext 对于带有 PS2 键盘、鼠标和触控板的旧系统，或者当您不想使用 VoodooInput 时 支持 macOS 10.6+ 支持 VoodooRMI.kext 和 VoodooSMBus.kext 对于带有 Synaptics SMBus 设备的触控板驱动 主要用于触控板和轨迹点，ThinkPad 小红点也可以驱动 MT2 (Magic Trackpad 2) 功能需要 macOS 10.11 或更新版本 VoodooSMBus.kext 对于带有基于 ELAN SMBus 的设备触控板驱动 主要用于触控板和轨迹点 目前支持 macOS 10.14 或更新版本 VoodooI2C.kext 用于修复 I2C 设备的触控板驱动 一般是一些更高级的触摸板和或者是触摸屏 MT2 (Magic Trackpad 2) 功能需要 macOS 10.11 或更新版本 VoodooI2C 的一些插件 VoodooI2CHID.kext：微软 HID 驱动，也支持某些型号的触控屏 VoodooI2CELAN.kext：ELAN 专用，ELAN1200+ 的版本需要 VoodooI2CHID.kext 代替 VoodooI2CSynaptics.kext：Synaptics 专用，Synaptics F12 协议需VoodooI2CHID代替 VoodooI2CFTE.kext：FTE1001 触控板 VoodooI2CAtmelMXT.kext：Atmel 多点触控协议 其他驱动 ECEnabler.kext 修复了在大多数笔记本上读取电池状态的问题（允许读取超过 8 位长的 EC 字段） BrightnessKeys.kext 笔记本亮度快捷键驱动 AsusSMC.kext 华硕笔记本电脑专用的 VirtualSMC 插件 提供 ALS、键盘背光和 Fn 键驱动，支持电池监控充电 支持配备了 ATK 设备的华硕笔记本电脑 CPUFriend.kext 和 CPUFriendDataProvider.kext 可以实现对 macOS CPU 频率睿频性能的调整 需要配合脚本生成时候自己机型的 kexts，可参考官方教程 黑苹果 Kexts 大全? 由于 Kexts 太多太杂了，这个工作量太大了，我直接贴一些轮子的地址，大家自己去看看就行： OpenCore 常用 Kexts 一些比较老的 Kexts 一些基于Liu 的 Kexts 如果你是一个有耐心的人的话，如果整理好 Kexts 完整列表的话，欢迎提交 PR powered by Gitbook该文章最后修改时间： 2021-09-19 21:04:36 "},"3-准备工作/3-5.html":{"url":"3-准备工作/3-5.html","title":"5. Drivers说明","keywords":"","body":"5. Drivers说明 完整的 Drivers 说明 OC/Drivers 里放着一些驱动文件，这些驱动均已 .efi 后缀结尾，OC 官方默认的驱动文件以及说明如下： AudioDxe.efi：用与启动的时候播放 Duang 的声音，就像白苹果那样 CrScreenshotDxe.efi：OC 引导界面截图驱动，按 F10 会保存当前界面的截图到 EFI 分区的根目录下 HiiDatabase.efi：用于支持 UEFI 字体渲染，四代酷睿后一般不需要 NvmExpressDxe.efi：用于让老主板支持 NVME Express 设备，四代酷睿后一般不需要 OpenCanopy.efi：使用图形化 OC 主题必备驱动 OpenHfsPlus.efi：文件系统驱动，用于支持识别 HFS+ 的磁盘格式 OpenLinuxBoot.efi：OC 0.7.3 新增的驱动，用于引导 Linux 系统 OpenPartitionDxe.efi：分区管理驱动程序。用于加载旧版 macOS 的 DMG 映像 OpenRuntime.efi：OC 核心必备驱动，功能比较强大，大家记住这个是必备的驱动就行 OpenUsbKbDxe.efi：USB 键盘驱动，用于模拟苹果热键，是 KeySupport 的等效方案 Ps2KeyboardDxe.efi：PS/2 键盘驱动，这个 PS/2 键盘也太老了吧，我好多年没见过了 Ps2MouseDxe.efi：PS/2 鼠标驱动，同样也太老了，很多年没有见过了 UsbMouseDxe.efi：USB 鼠标驱动，有些虚拟机需要依赖改驱动才可以在引导界面使用鼠标 XhciDxe.efi：XHCI USB controller 驱动程序，基本上 2 代酷睿开始大多数固件都自带这个驱动程序了 常用 Drivers 正常情况下，以下 2 个是必备的驱动： OpenRuntime.efi：OC 核心必备驱动，功能比较强大，大家记住这个是必备的驱动就行 OpenHfsPlus.efi：文件系统驱动，用于支持识别 HFS+ 的磁盘格式 因为国光有使用图形化界面引导和在引导界面截图的习惯，所以我还使用了如下两个驱动： OpenCanopy.efi：使用图形化 OC 主题必备驱动 CrScreenshotDxe.efi：OC 引导界面截图驱动，按 F10 会保存当前界面的截图到 EFI 分区的根目录下 使用主题前后对比 使用主题前 使用主题后 一些 OC 主题下载的渠道： https://dortania.github.io/OpenCanopy-Gallery/blackosx.html OC主题-黑苹果动力 https://github.com/LuckyCrack/OpenCore-Themes https://github.com/chris1111/My-Simple-OC-Themes powered by Gitbook该文章最后修改时间： 2021-09-19 21:04:36 "},"3-准备工作/3-6.html":{"url":"3-准备工作/3-6.html","title":"6. OC 编辑器","keywords":"","body":"6. OC 编辑器 因为 OpenCore 的核显配置 文件是 .list 结尾的，所以需要专门的编辑器来编辑，常见的 OC 编辑器的优缺点如下： 编辑器名称 优点 缺点 ProperTree 强大、专业、跨平台 上手难度高 OpenCore Configurator 强大、简单 只有 Mac 版本 QtOpenCoreConfig 跨平台、简单 使用体验有待提升 国光我的建议如下： 如果你有 Mac 系统可以使用，首选 OpenCore Configurator Windows 小白用户建议使用 QtOpenCoreConfig 下面来分别大概介绍一下这些编辑器的安装和使用方法。 提醒一下，不同版本的 OC 配置需要使用对应版本的 OC 编辑器，否则可能产生玄学问题 ProperTree 官方项目地址为：https://github.com/corpnewt/ProperTree macOS 平台下使用 因为 macOS 自带 Python 环境的原因，双击 ProperTree.command 即可打开程序： 通过 macOS 的菜单可以完成一些主要操作。 Windows 平台下使用 Windows 10 默认不带 Python 环境，所以首先得安装一下 Python 环境才可以。首先下载 Python3，这里推荐稳定一点的 Python 3.8 的版本，官方下载地址为：https://www.python.org/ftp/python/3.8.10/python-3.8.10-amd64.exe 安装的时候记得勾选：Add Python 3.8 to PATH： 这样会自动配置好环境变量，后面就不需要我们手动配置了，使用默认路径或者自定义路径都是OK的，国光比较偷懒使用了默认的「Install Now」，如果要使用自定义路径的话，那么这个路径最好不要出现中文，否则可能会引发一些玄学的问题。 验证是否安装成功的话，打开命令行，输入： python -V 可以看到 Python 的版本信息表示成功： 确实安装成功后，双击 ProperTree.bat 文件即可打开程序： 同样通过菜单中的 File 可以完成一些基础操作。 OpenCore Configurator OpenCore Configurator 最新版本的下载地址为： https://mackie100projects.altervista.org/download-opencore-configurator/ 找到 想要编辑的配置文件，「右键」-「打开方式」选择「OpenCore Configurator」即可： 打开后的主要界面如下： QtOpenCoreConfig QtOpenCoreConfig 建议在 Windows 使用，用来替代 ProperTree，因为 macOS 下有更棒的使用体验更好的 OpenCore Configurator 可以使用。 官方项目地址为：https://github.com/ic005k/QtOpenCoreConfig 中文说明为：https://github.com/ic005k/QtOpenCoreConfig/blob/master/READMe-en.md 下载对应的 Windows 版本的，然后打开 OCAuxiliaryTools.exe 即可，主要界面如下： 至此 OC 编辑器介绍完了，详细的使用方法大家可以参考本教程对应的 B 站讲解视频，接下来该准备配置 EFI 文件了。 powered by Gitbook该文章最后修改时间： 2021-09-19 21:04:36 "},"3-准备工作/3-7.html":{"url":"3-准备工作/3-7.html","title":"7. 初步配置","keywords":"","body":"7. 初步配置 调整文件夹结构 本部分的截图均来自于我的华擎 Z490 的开源项目 感兴趣的朋友可以自行去下载学习。 拷贝并重命名 Sample.plist 首先将 Doc 目录下的 Sample.plist 拷贝到 EFI/OC/ 目录下，并将其重命名为 config.list： 精简 Drivers Drivers 里面只留了几个必要的，详细部分可以参考前面的 Drivers 说明章节 精简 Tools 国光没有使用 Tools 的习惯，所以这里面的工具全部删掉了，Tools 里面文件的详细作用可以参考 前面的 OC 文件结构 章节： 放置属于你的 SSDT 根据前面 准备 ACPI 的部分，把你准备好的 SSDT 放入进来： 放置属于你的 Kexts 根据前面 准备 Kexts 的部分，把你准备好的 Kexts 放入进来： 替换主题文件 OC 官方默认是没有主题的，可以下载官方的简约经典主题，替换默认的 Resources 文件夹即可： config.list 加载文件 OC 和 Clover 不一样的地方在于，Clover 只需要把文件放入到该放的地方就行，但是 OC 不仅要放，还得手动加载才可以。 上一章推荐的 3 款编辑器都可以自动加载，下面来分部一一介绍一下他们加载的方法。 ProperTree ProperTree 运行后，通过按Cmd/Ctrl + O并选择config.plist上的文件来打开 config.plist，打开配置后，按Cmd/Ctrl + Shift + R 或者使用图形化菜单选择 「Clean Snapshot」： 接着选择要自带添加清理的 OC 文件夹： 完成后，您将在 config.plist 中看到就可以看到我们之前配置的 SSDT、Kexts 和 Drivers 信息了： 最后选择保存即可。 OpenCore Configurator 暂时没有发现 OpenCore Configurator 和 QtOpenCoreConfig 可以一键自动化添加 ACPI、Drivers、Kexts、Tools 之类的操作，所以我们只能手动来添加这些文件了。 添加 SSDTS 添加之前得删除原有的模板文件中的 SSDTS，操作很简单，选择所有，点击右下角的「减号」即可删除： 然后选择左下角的「快照添加」，选择你的 ACPI 文件夹里面的所有 SSDT 文件，打开即可完成添加操作： 添加好的效果如下： 可以看到自动添加好了路径信息，并都自动启用了。 添加 Kexts 添加 Kexts 也是类似的操作，国光这里不在啰嗦，先删除样例自带的，然后快照添加，选择 Kexts 文件夹即可： 当然 Kexts 加载的话还需要一些顺序等技巧，这个技巧会在下一个章节详细介绍。 添加 Drivers 添加 Drivers 也是类似的操作： 添加 Tools 添加 Tools 也是类似的操作，就是这个藏的稍微隐蔽了一点，具体添加入口参考下图： QtOpenCoreConfig QtOpenCoreConfig 的操作和 OpenCore Configurator 异曲同工，基本上都可以很快上手，如果不能很快上手的话，那肯定是这个图形化界面做的不够人人性化，使用体验不够友好。 添加 SSDTS 删除模板文件自带的 SSDT，然后选择你的 ACPI 文件夹里面的所有 SSDT 文件，打开即可完成添加操作： 添加 Kexts 添加 Kexts 也是类似的操作，但是 QtOpenCoreConfig 不支持添加整个 Kexts 文件夹，左下角加号只能手动一个个添加，为了高效的话可以选择所有的 Kexts 文件，然后拖入到 QtOpenCoreConfig 中的 Kernel 中即可： 当然 Kexts 加载的话还需要一些顺序等技巧，这个技巧会在下一个章节详细介绍。 添加 Drivers 添加 Drivers 也是类似的操作： 添加 Tools 添加 Tools 也是类似的操作，就是这个藏的稍微隐蔽了一点，具体添加入口参考下图： 至此我们之前收集的 ACPI、Kexts 等文件就这样手动加载完成了，下面章节开始介绍一下常见的 Kexts 的基本加载顺序。 powered by Gitbook该文章最后修改时间： 2021-09-19 22:07:39 "},"3-准备工作/3-8.html":{"url":"3-准备工作/3-8.html","title":"8. Kexts 微调","keywords":"","body":"8. Kexts 微调 Kexts 也有顺序的要求，而且有些 Kexts 会冲突无法开机，关于这块也比杂了，因为 Kexts 的开发者都不相同，所以国光我只能尽力去描述了，如果文档描述不清楚的话，可以去看 B 站对应的讲解视频。 自动调整 Kexts 顺序 ProperTree 在进行 Cmd/Ctrl + Shift + R 或者使用图形化菜单选择 「Clean Snapshot」操作的时候，会自动调整 Kexts 的加载顺序并且禁用掉冲突的 Kexts 实际上 OpenCore Configurator 也有这个功能，点击底部的「检查 Kexts」即可： 手动调整 Kexts 顺序 软件自动调整的顺序不一定是最准确的，因为他不知道你用了哪些乱七八糟的 Kexts，所以有时候还需要我们手动调整下 Kexts 的加载顺序。 OpenCore Configurator OpenCore Configurator 操作比较简单，选择好你要操作的 Kext，然后直接上下拖动即可调整顺序： QtOpenCoreConfig QtOpenCoreConfig 虽然无法直接拖动，但可以使用底部的「向上」和「向下」箭头的图标来调整 Kexts 的加载顺序： 常见 Kexts 的调整细节 必备 Kexts 的加载顺序 Lilu.kext VirtualSMC.kext WhateverGreen.kext SMCBatteryManager.kext （台式机不需要） SMCLightSensor.kext （台式机不需要） SMCProcessor.kext SMCSuperIO.kext AppleALC.kext BCM 博通无线和蓝牙加载顺序 AirportBrcmFixup.kext BrcmBluetoothInjector.kext BrcmFirmwareData.kext BrcmPatchRAM3.kext BCM 博通无线细节调整 直接加载 AirportBrcmFixup.kext 会发现实际上加载了 3 个 Kext： AirportBrcmFixup.kext AirportBrcmFixup.kext/Contents/PlugIns/AirPortBrcmNIC_Injector.kext AirportBrcmFixup.kext/Contents/PlugIns/AirPortBrcm4360_Injector.kext 其中安装 Big Sur 以及更新版本的话，AirPortBrcm4360_Injector.kext 默认情况下会出问题，所以需要我们设置一下最大内核为 19.9.9 ，这样可能会减少一些异常错误： 另外，BCM94352Z 芯片的网卡往往还需要在启动项里面添加：brcmfx-driver=2 解决一些睡眠或者其他玄学问题： Intel 无线和蓝牙加载顺序 AirportItlwm.kext IntelBluetoothInjector.kext IntelBluetoothFirmware.kext 笔记本 PS2 键鼠、触控板加载顺序 VoodooPS2Controller.kext VoodooPS2Controller.kext/Contents/PlugIns/VoodooPS2Keyboard.kext VoodooPS2Controller.kext/Contents/PlugIns/VoodooPS2Mouse.kext VoodooPS2Controller.kext/Contents/PlugIns/VoodooPS2Trackpad.kext VoodooPS2Controller.kext/Contents/PlugIns/VoodooInput.kext BrightnessKeys.kext（功能亮度调节按键驱动 不一定需要） 笔记本 I2C 和 PS2 配合驱动触控板加载顺序 VoodooI2C.kext/Contents/PlugIns/VoodooI2CServices.kext VoodooI2C.kext/Contents/PlugIns/VoodooGPIO.kext VoodooI2C.kext VoodooI2CHID.kext VoodooPS2Controller.kext VoodooPS2Controller.kext/Contents/PlugIns/VoodooPS2Keyboard.kext VoodooI2C.kext/Contents/PlugIns/VoodooInput.kext BrightnessKeys.kext （功能亮度调节按键驱动 不一定需要） 补充一个小姿势：因为 IC2 和 PS2 都有 VoodooInput.kext，所以如果不删除掉或者禁用掉 PS2 的 VoodooInput.kext 的话，会导致开机内核冲突卡死无法开机。 笔记本 PS2Smart 键盘驱动加载顺序 ApplePS2SmartTouchPad.kext/Contents/PlugIns/ApplePS2Controller.kext ApplePS2SmartTouchPad.kext/Contents/PlugIns/ApplePS2Keyboard.kext ApplePS2SmartTouchPad.kext 笔记本 VoodooRMI.kext 和 VoodooSMBus.kext 细节调整 首先确保 VoodooPS2 配置如下： 启用 VoodooPS2Controller.kext VoodooPS2Controller.kext/Contents/PlugIns/VoodooPS2Mouse.kext VoodooPS2Controller.kext/Contents/PlugIns/VoodooPS2Keyboard.kext VoodooPS2Controller.kext/Contents/PlugIns/VoodooPS2Trackpad.kext 禁用 VoodooPS2Controller.kext/Contents/PlugIns/VoodooInput.kext 然后启用加载基础的 RMI 配置： VoodooRMI.kext VoodooRMI.kext/Contents/PlugIns/VoodooInput.kext 如果你是 SMBus 触控板的话，还需要加载： VoodooSMBus.kext VoodooRMI.kext/Contents/PlugIns/RMISMBus.kext 如果你是 I2C触控板的话，还需要加载： VoodooI2C.kext VoodooRMI.kext/Contents/PlugIns/RMII2C.kext powered by Gitbook该文章最后修改时间： 2021-09-19 22:59:56 "},"4-OC配置/":{"url":"4-OC配置/","title":"五、配置 config.list","keywords":"","body":"五、配置 config.list 正式配置 OC 配置文件的一些细节操作，主要包括如下内容： 1. ACPI 2. Booter 3. DeviceProperties 4. Kernel 5. Misc 6. NVRAM 7. PlatformInfo 8. UEFI powered by Gitbook该文章最后修改时间： 2021-09-19 23:14:24 "},"4-OC配置/4-1.html":{"url":"4-OC配置/4-1.html","title":"1. ACPI","keywords":"","body":"1. ACPI 通过上一节准备工作的配置，我们的 SSDT 应该都已经加载进来了，此时一般调整下 Quiks（怪癖）即可，少数的 SSDT 需要打对应的补丁才可以生效，关于打补丁细节可以参考视频内容，不过下面的示例配置如果需要打补丁的话，也会写出来的，模仿一下即可。 完整的 Quiks 怪癖 因为各个平台的版本不太一样，在详细说明之前写来一个 OC 0.7.3 完整的 Quiks 怪癖 说明，这样心里大家设置的时候心里一般就有个底了。 FadtEnableReset 在旧硬件上修复重启和关机, 除非需要, 否则不推荐开启 一些较新的笔记本可能也需要这个选项来修复重启和关机 NormalizeHeaders 清除 ACPI 头字段, 只有 macOS 10.13 需要 10.14 后面的版本已经修复这个问题了 RebaseRegions 尝试试探性地重新定位 ACPI 内存区域, 使用自定义 DSDT 则必须开启 ResetHwSig 适用于无法在重新启动期间维护硬件签名并导致从休眠中唤醒问题的硬件 ResetLogoStatus 无法在有 BGRT 表的系统上显示 OEM Windows 标志的硬件需要开启 SyncTableIds 这可以解决修补表与 SLIC 表不兼容导致旧 Windows 操作系统中的许可问题。 Intel 桌面平台 Yonah、Conroe、Penryn、Lynnfield、Clarkdale 最初支持的版本为 OS X 10.4.10，最后支持的操作系统版本为 macOS 10.13.6 这些版本不需要调整 Quiks 怪癖，全部保持示例配置中默认的即可。 Sandy Bridge、Ivy Bridge Sandy Bridge 的 iGPU 核显仅在 macOS 10.13 之前得到官方支持，大多数 Sandy 桥接的主板不支持 UEFI Sandy Bridge 和 Ivy Bridge 的 ACPI 往往需要配合「删除」使用：删除 CpuPm、删除 Cpu0Ist 幸运的是，默认示例文件自带了这些，我们只需要勾选「启用」就 OK 了： 这些版本不需要调整 Quiks 怪癖，全部保持示例配置中默认的即可。 Haswell、Broadwell、Skylake、Kaby Lake、Coffee Lake、Comet Lake 这些版本不需要调整 Quiks 怪癖，全部保持示例配置中默认的即可。 Intel 高端桌面平台 Nehalem 、Westmere、Sandy、Ivy Bridge-E、Haswell-E、Broadwell-E、Skylake-X/W 、Cascade Lake-X/W 这些版本不需要调整 Quiks 怪癖，全部保持示例配置中默认的即可。 Intel 笔记本平台 Clarksfield、Arrandale 因为使用了 SSDT-XOSI 的原因，所以还需要配合 Change _OSI to XOSI 补丁来使用： Comment String Change _OSI to XOSI Enabled Boolean YES Count Number 0 Limit Number 0 Find Data 5f4f5349 Replace Data 584f5349 OCC 里面也集成了这个 XOSI 补丁，只需要一键就可以补丁并启用： 这些版本不需要调整 Quiks 怪癖，全部保持示例配置中默认的即可。 Sandy Bridge、Ivy Bridge Sandy Bridge 的 iGPU 核显仅在 macOS 10.13 之前得到官方支持，大多数 Sandy 桥接的主板不支持 UEFI Sandy Bridge 和 Ivy Bridge 的 ACPI 往往需要配合「删除」使用：删除 CpuPm、删除 Cpu0Ist 幸运的是，默认示例文件自带了这些，我们只需要勾选「启用」就 OK 了： 因为使用了 SSDT-XOSI 的原因，所以还需要配合 Change _OSI to XOSI 补丁来使用： Comment String Change _OSI to XOSI Enabled Boolean YES Count Number 0 Limit Number 0 Find Data 5f4f5349 Replace Data 584f5349 OCC 里面也集成了这个 XOSI 补丁，只需要一键就可以补丁并启用： 这些版本不需要调整 Quiks 怪癖，全部保持示例配置中默认的即可。 Haswell、Broadwell、Skylake、Kaby Lake、Coffee Lake 、Whiskey Lake、Coffee Lake Plus、Comet Lake、Icelake 因为使用了 SSDT-XOSI 的原因，所以还需要配合 Change _OSI to XOSI 补丁来使用： Comment String Change _OSI to XOSI Enabled Boolean YES Count Number 0 Limit Number 0 Find Data 5f4f5349 Replace Data 584f5349 OCC 里面也集成了这个 XOSI 补丁，只需要一键就可以补丁并启用： 这些版本不需要调整 Quiks 怪癖，全部保持示例配置中默认的即可。 AMD 桌面平台 Bulldozer(15h)、Jaguar(16h)、Ryzen、Threadripper(17h and 19h) 这些版本不需要调整 Quiks 怪癖，全部保持示例配置中默认的即可。 powered by Gitbook该文章最后修改时间： 2021-09-20 22:15:24 "},"4-OC配置/4-2.html":{"url":"4-OC配置/4-2.html","title":"2. Booter","keywords":"","body":"2. Booter 本节允许对操作系统引导加载程序应用不同类型的UEFI修改，主要是Apple引导加载程序（boot.efi）。这些修改目前为不同的固件类型提供了各种修补程序和环境更改。其中一些功能最初是作为 AptioeMoryFix.efi （不再维护）的一部分实现的。 完整的 Quiks 怪癖 因为各个平台的版本不太一样，在详细说明之前写来一个 OC 0.7.3 完整的 Quiks 怪癖 说明，这样心里大家设置的时候心里一般就有个底了。 AllowRelocationBlock 允许通过重新定位块引导 macOS 此怪癖需要启用 ProvideCustomSlide，通常还需要启用 AvoidRuntimeDefrag 才能正常工作 虽然在使用较低内存的平台上运行旧 macOS 版本需要这种怪癖 但它与某些硬件和 Mac OS 11 不兼容，在这种情况下，应考虑使用 EnableSafeModeSlide AvoidRuntimeDefrag 防止 boot.efi 运行时内存碎片整理 开启后会修复 UEFI 的运行服务, 例如日期、时间、NVRAM、电源控制 除了苹果和 VMware 之外，大多数类型的固件都需要这种怪癖 DevirtualiseMmio 从某些 MMIO 区域删除运行时属性 删除已知内存区域的运行时位来减少内存映射中被盗的内存占用 一般情况下，采用 slide=1 的方式进行连续性内存注入，故一般不勾选，除非你的机器用了 KASLR 方式。 DisableSingleUser 禁用单用户模式 开启后会禁止 Cmd + S 和 -s 的使用，使设备更加接近于 T2 白苹果 DisableVariableWrite 防止 macOS NVRAM 写入访问 开启后会禁止 NVRAM 写入, 在 Z390/HM370 等没有原生 macOS 支持 NVRAM 的主板上需要开启 DiscardHibernateMap 开启后会重用原始休眠内存映射，仅某些旧硬件需要 EnableSafeModeSlide 开启后会允许在安全模式下使用 Slide 值 安全模式下（-x）是否用连续性的内存注入方式 EnableWriteUnprotector 允许对 UEFI 运行时服务代码进行写访问 开启后会在执行期间删除 CR0 寄存器中的写入保护 ForceExitBootServices 失败时使用新内存映射重试 ExitBootServices 开启后会确保 ExitBootServices 即使在 MemoryMap 发生更改时也能调用成功 一般很老很旧的主板可能需要使用，新主板一般不需要使用 ProtectMemoryRegions 保护内存区域不被错误访问 确保 CSM 内存区域标记为 ACPI NVS，以防止 boot.efi 或 XNU 重新定位或使用它们 AvoidRuntimeDefrag 解决了类似的问题。默认不勾选 一些老旧的主板可能需要勾选 ProtectSecureBoot 保护 UEFI 安全引导变量不被写入 避免操作系统对 UEFI 安全启动变量 (db, dbx, PX, KEK) 进行写入 这个选项主要用于避免 Insyde 主板和 MacPro5,1 的 NVRAM 问题 ProtectUefiServices 保护 UEFI 服务不被固件覆盖 用于修复 Z390 在 DevirtualiseMmio、ProtectCsmRegion 或 ShrinkMemoryMap 上的问题 非 Z390 主板一般默认不勾选 ProvideCustomSlide 在内存不足时提供自定义 KASLR 幻灯片 此选项时强制 macOS 在可用的 slide 值中使用一个随机的、不产生冲突的 slide 值 如果 Slide 值存在冲突, 此选项将强制 macOS 执行以下操作，使用一个伪随机值 只有在遇到 Only N/256 slide values are usable! 时需要 RebuildAppleMemoryMap 重建 macOS 兼容的内存映射 一般在启动 macOS 10.6 及更早版本时可能需要这个选项 SetupVirtualMap 在 SetVirtualAddresses 上设置虚拟内存 开启后会将 SetVirtualAddresses 调用修复为虚拟地址 通过虚拟内存建立连续性内存供 OC 使用，并映射到分散的物理内存中 SignalAppleOS 通过任何操作系统的操作系统信息报告正在加载的 macOS 将其他操作系统的信息报告给正在加载的 macOS 用于在 Windows 中为 MacBook 启用 iGPU SyncRuntimePermissions 更新运行时环境的内存权限 主要用于早期的 macOS 或 Linux/Windows Intel 桌面平台 Yonah、Conroe、Penryn 传统引导设置 Quirk Enabled Comment AvoidRuntimeDefrag No Big Sur 可能需要启用此怪癖 EnableSafeModeSlide No EnableWriteUnprotector No ProvideCustomSlide No RebuildAppleMemoryMap Yes 这是引导 OS X 10.4 到 10.6 所必需的 SetupVirtualMap No UEFI 引导设置 Quirk Enabled Comment RebuildAppleMemoryMap Yes 这是引导 OS X 10.4 到 10.6 所必需的 Lynnfield、Clarkdale 传统引导设置 Quirk Enabled Comment AvoidRuntimeDefrag No Big Sur 可能需要启用此怪癖 EnableSafeModeSlide No EnableWriteUnprotector No ProvideCustomSlide No RebuildAppleMemoryMap Yes 这是引导 OS X 10.4 到 10.6 所必需的 SetupVirtualMap No UEFI 引导设置 Quirk Enabled Comment RebuildAppleMemoryMap Yes 这是引导 OS X 10.4 到 10.6 所必需的 Sandy Bridge、Ivy Bridge、Haswell、Broadwell、Skylake、Kaby Lake ProperTree OpenCore Configurator QtOpenCoreConfig Coffee Lake、Comet Lake ProperTree OpenCore Configurator QtOpenCoreConfig Intel 高端桌面平台 Nehalem、Westmere 传统引导设置 Quirk Enabled Comment AvoidRuntimeDefrag No Big Sur 可能需要启用此怪癖 EnableSafeModeSlide No EnableWriteUnprotector No ProvideCustomSlide No RebuildAppleMemoryMap Yes 这是引导 OS X 10.4 到 10.6 所必需的 SetupVirtualMap No UEFI 引导设置 Quirk Enabled Comment RebuildAppleMemoryMap Yes 这是引导 OS X 10.4 到 10.6 所必需的 Sandy、Ivy Bridge-E、 Haswell-E、Broadwell-E ProperTree OpenCore Configurator QtOpenCoreConfig Skylake-X/W、Cascade Lake-X/W ProperTree OpenCore Configurator QtOpenCoreConfig Intel 笔记本平台 Clarksfield、Arrandale Arrandale 的 iGPU 核显仅在 macOS 10.13 之前得到官方支持，大多数 Clarksfield 和 Arrandale 主板不支持 UEFI 传统引导设置 Quirk Enabled Comment AvoidRuntimeDefrag No Big Sur 可能需要启用此怪癖 EnableSafeModeSlide No EnableWriteUnprotector No ProvideCustomSlide No RebuildAppleMemoryMap Yes 这是引导 OS X 10.4 到 10.6 所必需的 SetupVirtualMap No UEFI 引导设置 Quirk Enabled Comment RebuildAppleMemoryMap Yes 这是引导 OS X 10.4 到 10.6 所必需的 Sandy Bridge、Ivy Bridge、Haswell、Broadwell、Skylake、Kaby Lake Sandy Bridge 的 iGPU 仅在 macOS 10.13 之前得到官方支持、大多数 Sandy 主板不支持 UEFI ProperTree OpenCore Configurator QtOpenCoreConfig Coffee Lake、Whiskey Lake ProperTree OpenCore Configurator QtOpenCoreConfig Coffee Lake Plus、Comet Lake ProperTree OpenCore Configurator QtOpenCoreConfig Icelake ProperTree OpenCore Configurator QtOpenCoreConfig AMD 桌面平台 Bulldozer(15h)、Jaguar(16h) ProperTree OpenCore Configurator QtOpenCoreConfig Ryzen、Threadripper(17h and 19h) ProperTree DevirtualiseMmio 注意 TRx40 需要这个标志 SetupVirtualMap 注意 B550、A520 和 TRx40 板应禁用此功能。 较新的 X570 BIOS 版本也需要禁用此功能 2020 年末 BIOS 更新的 X470 和 B450 也需要禁用此功能 OpenCore Configurator QtOpenCoreConfig powered by Gitbook该文章最后修改时间： 2021-09-20 17:04:11 "},"4-OC配置/4-3.html":{"url":"4-OC配置/4-3.html","title":"3. DeviceProperties","keywords":"","body":"3. DeviceProperties 设备配置通过专用缓冲区提供给 macOS，用于设置 PCI 设备属性，如英特尔缓冲帧补丁，声卡 Layout ID 等。当然声卡的 ID 也可以直接通过启动项添加 alcid=xx 这种形式来添加也是 OK 的。 寻找设备地址 不同的设备的硬件地址是不一样的，可以使用 Hackintool 查看具体的地址信息： 或者直接使用 OCC 也是可以识别添加设备地址信息的： 添加好的效果如下： 当然设备属性这里还是有一些缺失的，这就需要我们来手动来补充了。 Intel 桌面平台 Yonah、Conroe 、Penryn、Lynnfield、Clarkdale PciRoot(0x0)/Pci(0x1b,0x0) layout-id AppleALC 音频注入，完整的 ALC ID 可以参考：[AppleALC 支持设备列表]( 这些平台无需特殊设置，只需要添加完善声卡信息即可，当然也可以直接通过启动项添加，前期调试的过程中，国光我建议大家是通过启动项添加 alcid=xx 这种形式。 Sandy Bridge PciRoot(0x0)/Pci(0x1b,0x0) layout-id AppleALC 音频注入，完整的 ALC ID 可以参考：AppleALC 支持设备列表 PciRoot(0x0)/Pci(0x2,0x0) 配置 iGPU 核显 AAPL,snb-platform-id macOS 用来确定 iGPU 驱动程序如何与我们的系统交互的 device-id 解决一些驱动异常问题，提高兼容度 AAPL,snb-platform-id 说明解释 10000300 当桌面 iGPU 用于驱动显示器时使用 00000500 当桌面 iGPU 仅用于计算任务而不驱动显示器时使用（有独显的时候可以考虑） device-id 说明解释 26010000 当桌面 iGPU 用于驱动显示器时使用 02010000 当桌面 iGPU 仅用于计算任务而不驱动显示器时使用（有独显的时候可以考虑） 下面是桌面 HD 3000 核显的最终配置的示例： Ivy Bridge PciRoot(0x0)/Pci(0x1b,0x0) layout-id AppleALC 音频注入，完整的 ALC ID 可以参考：AppleALC 支持设备列表 PciRoot(0x0)/Pci(0x2,0x0) 配置 iGPU 核显 AAPL,ig-platform-id macOS 用来确定 iGPU 驱动程序如何与我们的系统交互的 device-id 解决一些驱动异常问题，提供兼容度 AAPL,ig-platform-id 说明解释 0A006601 当桌面 iGPU 用于驱动显示器时使用 07006201 当桌面 iGPU 仅用于计算任务而不驱动显示器时使用（有独显的时候可以考虑） 台式机 HD 4000 核显的 AAPL,ig-platform-id 为 0A006601 PciRoot(0x0)/Pci(0x16,0x0) Ivy Bridge CPU 与 6 系列主板（即 H61、B65、Q65、P67、H67、Q67、Z68）配合使用需要 欺骗 IMEI 设备以获得支持 无论是否使用 SSDT-IMEI，此属性仍然是必需的 Key Type Value device-id Data 3A1E0000 如果是 7 系列主板（即 B75、Q75、Z75、H77、Q77、Z77），则不需要此项 Haswell、Broadwell PciRoot(0x0)/Pci(0x1b,0x0) layout-id AppleALC 音频注入，完整的 ALC ID 可以参考：AppleALC 支持设备列表 PciRoot(0x0)/Pci(0x2,0x0) 配置 iGPU 核显 AAPL,ig-platform-id macOS 用来确定 iGPU 驱动程序如何与我们的系统交互的 device-id 解决一些驱动异常问题，提高兼容度 framebuffer-patch-enable 启用通过 WhateverGreen.kext 进行修补 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 也不需要 framebuffer-stolenmem 设置核显最小被盗内存 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 的话也不需要 framebuffer-fbmem 设置缓冲帧内存大小 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 的话也不需要 AAPL,ig-platform-id 解释说明 0300220D 当 Desktop Haswell iGPU 用于驱动显示器时使用 04001204 当 Desktop Haswell iGPU 仅用于计算任务而不驱动显示器时使用 07002216 桌面 Broadwell iGPU 时使用 device-id 说明解释 12040000 HD 4600 核显的设备 ID 下面是 HD 4400 核显的最终配置的示例： Key Type Value AAPL,ig-platform-id Data 0300220D framebuffer-patch-enable Data 01000000 framebuffer-stolenmem Data 00003001 framebuffer-fbmem Data 00009000 device-id Data 12040000 下面是 lris Pro 6200 核显的最终配置示例： Key Type Value AAPL,ig-platform-id Data 07002216 framebuffer-patch-enable Data 01000000 framebuffer-stolenmem Data 00003001 framebuffer-fbmem Data 00009000 Skylake PciRoot(0x0)/Pci(0x1b,0x0) layout-id AppleALC 音频注入，完整的 ALC ID 可以参考：AppleALC 支持设备列表 PciRoot(0x0)/Pci(0x2,0x0) 配置 iGPU 核显 AAPL,ig-platform-id macOS 用来确定 iGPU 驱动程序如何与我们的系统交互的 device-id 解决一些驱动异常问题，提高兼容度 framebuffer-patch-enable 启用通过 WhateverGreen.kext 进行修补 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 也不需要 framebuffer-stolenmem 设置核显最小被盗内存 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 的话也不需要 framebuffer-fbmem 设置缓冲帧内存大小 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 的话也不需要 AAPL,ig-platform-id 解释说明 00001219 当桌面 iGPU 用于驱动显示器时使用 01001219 当桌面 iGPU 仅用于计算任务而不驱动显示器时使用 HD P530 核显用户需要注意的是，您的 iGPU 核显不受本机支持，因此您需要添加以下属性： Key Type Value device-id Data 1B190000 下面是 HD P530 核显的最终配置示例： Key Type Value AAPL,ig-platform-id Data 00001219 framebuffer-patch-enable Data 01000000 framebuffer-stolenmem Data 00003001 framebuffer-fbmem Data 00009000 device-id Data 1B190000 Kaby Lake PciRoot(0x0)/Pci(0x1b,0x0) layout-id AppleALC 音频注入，完整的 ALC ID 可以参考：AppleALC 支持设备列表 PciRoot(0x0)/Pci(0x2,0x0) 配置 iGPU 核显 AAPL,ig-platform-id macOS 用来确定 iGPU 驱动程序如何与我们的系统交互的 device-id 解决一些驱动异常问题，提高兼容度 framebuffer-patch-enable 启用通过 WhateverGreen.kext 进行修补 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 也不需要 framebuffer-stolenmem 设置核显最小被盗内存 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 的话也不需要 framebuffer-fbmem 设置缓冲帧内存大小 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 的话也不需要 下面是 HD630 核显的最终配置示例： Key Type Value AAPL,ig-platform-id Data 00001259 framebuffer-patch-enable Data 01000000 framebuffer-stolenmem Data 00003001 Coffee Lake PciRoot(0x0)/Pci(0x1b,0x0) layout-id AppleALC 音频注入，完整的 ALC ID 可以参考：AppleALC 支持设备列表 PciRoot(0x0)/Pci(0x2,0x0) 配置 iGPU 核显 AAPL,ig-platform-id macOS 用来确定 iGPU 驱动程序如何与我们的系统交互的 device-id 解决一些驱动异常问题，提高兼容度 framebuffer-patch-enable 启用通过 WhateverGreen.kext 进行修补 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 也不需要 framebuffer-stolenmem 设置核显最小被盗内存 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 的话也不需要 framebuffer-fbmem 设置缓冲帧内存大小 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 的话也不需要 AAPL,ig-platform-id 解释说明 07009B3E 当桌面 iGPU 用于驱动显示器时使用 00009B3E 如果07009B3E 不起作用的话，可以考虑使用这个 ID 看看 0300913E 当桌面 iGPU 仅用于计算任务而不驱动显示器时使用 下面是 HD630 核显的最终配置示例： Key Type Value AAPL,ig-platform-id Data 07009B3E framebuffer-patch-enable Data 01000000 framebuffer-stolenmem Data 00003001 Comet Lake PciRoot(0x0)/Pci(0x1b,0x0) layout-id AppleALC 音频注入，完整的 ALC ID 可以参考：AppleALC 支持设备列表 PciRoot(0x0)/Pci(0x2,0x0) 配置 iGPU 核显 AAPL,ig-platform-id macOS 用来确定 iGPU 驱动程序如何与我们的系统交互的 device-id 解决一些驱动异常问题，提高兼容度 framebuffer-patch-enable 启用通过 WhateverGreen.kext 进行修补 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 也不需要 framebuffer-stolenmem 设置核显最小被盗内存 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 的话也不需要 framebuffer-fbmem 设置缓冲帧内存大小 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 的话也不需要 AAPL,ig-platform-id 解释说明 07009B3E 当桌面 iGPU 用于驱动显示器时使用 00009B3E 如果07009B3E 不起作用的话，可以考虑使用这个 ID 看看 0300C89B 当桌面 iGPU 仅用于计算任务而不驱动显示器时使用 下面是 HD630 核显的最终配置示例： Key Type Value AAPL,ig-platform-id Data 07009B3E framebuffer-patch-enable Data 01000000 framebuffer-stolenmem Data 00003001 Intel 高端桌面平台 Nehalem、Westmere、Sandy and Ivy Bridge-E、Haswell-E、Skylake-X/W and Cascade Lake-X/W PciRoot(0x0)/Pci(0x1b,0x0) layout-id 用 AppleALC 音频注入，完整的 ALC ID 可以参考：AppleALC 支持设备列表 这些平台无需特殊设置，只需要添加完善声卡信息即可，当然也可以直接通过启动项添加，前期调试的过程中，国光我建议大家是通过启动项添加 alcid=xx 这种形式。 Intel 笔记本平台 Skylake-X/W、Cascade Lake-X/W PciRoot(0x0)/Pci(0x1b,0x0) layout-id 用 AppleALC 音频注入，完整的 ALC ID 可以参考：AppleALC 支持设备列表 PciRoot(0x0)/Pci(0x2,0x0) 配置 iGPU 核显 AAPL,ig-platform-id macOS 用来确定 iGPU 驱动程序如何与我们的系统交互的 framebuffer-patch-enable 启用通过 WhateverGreen.kext 进行修补 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 也不需要 framebuffer-singlelink 帧缓冲区单链接 一些老的笔记本需要配置这个选项 Property Type Value framebuffer-patch-enable Data 01000000 framebuffer-singlelink Data 01000000 Sandy Bridge PciRoot(0x0)/Pci(0x1b,0x0) layout-id AppleALC 音频注入，完整的 ALC ID 可以参考：AppleALC 支持设备列表 PciRoot(0x0)/Pci(0x2,0x0) 配置 iGPU 核显 AAPL,snb-platform-id macOS 用来确定 iGPU 驱动程序如何与我们的系统交互的 AAPL,snb-platform-id Type 解释说明 00000100 Laptop 笔记本电脑使用 10000300 NUC Intel NUC 使用 PciRoot(0x0)/Pci(0x16,0x0) 使用 Sandy Bridge CPU 和 Ivy Bridge 芯片组常用的配置 欺骗 IMEI 设备以获得支持 无论是否使用 SSDT-IMEI，此属性仍然是必需的 芯片组为 Hx6x 的机型需要配置，可以室友 AIDA64 查看下，比如 Core i3-3110M 的芯片组为 HM67 Key Type Value device-id Data 3A1C0000 Ivy Bridge PciRoot(0x0)/Pci(0x1b,0x0) layout-id AppleALC 音频注入，完整的 ALC ID 可以参考：AppleALC 支持设备列表 PciRoot(0x0)/Pci(0x2,0x0) 配置 iGPU 核显 AAPL,ig-platform-id macOS 用来确定 iGPU 驱动程序如何与我们的系统交互的 device-id 解决一些驱动异常问题，提高兼容度 framebuffer-patch-enable 启用通过 WhateverGreen.kext 进行修补 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 也不需要 framebuffer-memorycount 匹配 FBMemoryCount framebuffer-pipecount 匹配 PipeCount framebuffer-portcount 匹配 PortCount framebuffer-stolenmem 设置核显最小被盗内存 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 的话也不需要 framebuffer-con1-enable 启用外接显示器 1 的修补 framebuffer-con1-alldata 显示器 1 的连接信息（端口信息等） AAPL,ig-platform-id Type 解释说明 03006601 Laptop 1366*768 或者更低分辨率的显示器推荐使用 04006601 Laptop 1600*900 或者更高分辨率的显示器推荐使用 09006601 Laptop 如果上面两个 ID 不行的话，可以试试看，主要是与某些 eDP 显示器配合使用 0B006601 NUC Intel NUC 推荐使用 缓冲区的设置如下： framebuffer-patch-enable Number 1 framebuffer-memorycount Number 2 framebuffer-pipecount Number 2 framebuffer-portcount Number 4 framebuffer-stolenmem Data 00000004 framebuffer-con1-enable Number 1 framebuffer-con1-alldata Data 02050000 00040000 07040000 03040000 00040000 81000000 04060000 00040000 81000000 Haswell PciRoot(0x0)/Pci(0x1b,0x0) layout-id AppleALC 音频注入，完整的 ALC ID 可以参考：AppleALC 支持设备列表 PciRoot(0x0)/Pci(0x2,0x0) 配置 iGPU 核显 AAPL,ig-platform-id macOS 用来确定 iGPU 驱动程序如何与我们的系统交互的 device-id 解决一些驱动异常问题，提高兼容度 framebuffer-patch-enable 启用通过 WhateverGreen.kext 进行修补 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 也不需要 framebuffer-stolenmem 设置核显最小被盗内存 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 的话也不需要 framebuffer-fbmem 设置缓冲帧内存大小 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 的话也不需要 AAPL,ig-platform-id Type 解释说明 0500260A Laptop HD 5000、HD 5100 和 HD 5200 核显推荐的 ID 值 0600260A Laptop HD 4200、HD 4400 和 HD 4600 核显推荐的 ID 值，需要配合 Device-id 0300220D NUC 推荐所有的 Hasewell 架构的 NUC 使用，核显推荐的 ID 值。需要配合 Device-id 缓冲区的设置如下： Key Type Value framebuffer-patch-enable Data 01000000 framebuffer-cursormem Data 00009000 针对 HD 4200, HD 4400 and HD 4600 核显配套使用的 Device-id 值： Key Type Value device-id Data 12040000 Broadwell PciRoot(0x0)/Pci(0x1b,0x0) layout-id AppleALC 音频注入，完整的 ALC ID 可以参考：AppleALC 支持设备列表 PciRoot(0x0)/Pci(0x2,0x0) 配置 iGPU 核显 AAPL,ig-platform-id macOS 用来确定 iGPU 驱动程序如何与我们的系统交互的 device-id 解决一些驱动异常问题，提高兼容度 framebuffer-patch-enable 启用通过 WhateverGreen.kext 进行修补 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 也不需要 framebuffer-stolenmem 设置核显最小被盗内存 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 的话也不需要 framebuffer-fbmem 设置缓冲帧内存大小 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 的话也不需要 AAPL,ig-platform-id Type 解释说明 06002616 Laptop 推荐大多数的笔记本使用 02001616 NUC 推荐 Broadwell 架构的 NUC 使用 如果你的显卡是 HD 5600 的话，一般还需要伪造一下 device-id 值： Key Type Value device-id data 26160000 缓冲区的设置如下： Key Type Value framebuffer-patch-enable Data 01000000 framebuffer-stolenmem Data 00003001 framebuffer-fbmem Data 00009000 Skylake PciRoot(0x0)/Pci(0x1b,0x0) layout-id AppleALC 音频注入，完整的 ALC ID 可以参考：AppleALC 支持设备列表 PciRoot(0x0)/Pci(0x2,0x0) 配置 iGPU 核显 AAPL,ig-platform-id macOS 用来确定 iGPU 驱动程序如何与我们的系统交互的 device-id 解决一些驱动异常问题，提高兼容度 framebuffer-patch-enable 启用通过 WhateverGreen.kext 进行修补 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 也不需要 framebuffer-stolenmem 设置核显最小被盗内存 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 的话也不需要 framebuffer-fbmem 设置缓冲帧内存大小 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 的话也不需要 AAPL,ig-platform-id Type 解释说明 00001619 Laptop HD 515, HD 520, HD 530, HD 540, HD 550 and P530 核显推荐使用 00001E19 Laptop 如果你上面的 ID 不行的话，可以尝试这个 00001B19 Laptop HD 510 推荐使用 00001E19 NUC HD 515 推荐使用 02001619 NUC HD 520/530 推荐使用 02002619 NUC HD 540/550 推荐使用 05003B19 NUC HD 580 推荐使用 如果你的核显为 HD 510 的话呢，一般还需要伪造一下 device-id 值： Key Type Value device-id Data 02190000 如果你的核显为 HD 550、P530 的话呢，一般还需要伪造一下 device-id 值： Key Type Value device-id Data 16190000 缓冲区的设置如下： Key Type Value framebuffer-patch-enable Data 01000000 framebuffer-stolenmem Data 00003001 framebuffer-fbmem Data 00009000 Kaby Lake PciRoot(0x0)/Pci(0x1b,0x0) layout-id AppleALC 音频注入，完整的 ALC ID 可以参考：AppleALC 支持设备列表 PciRoot(0x0)/Pci(0x2,0x0) 配置 iGPU 核显 AAPL,ig-platform-id macOS 用来确定 iGPU 驱动程序如何与我们的系统交互的 device-id 解决一些驱动异常问题，提高兼容度 framebuffer-patch-enable 启用通过 WhateverGreen.kext 进行修补 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 也不需要 framebuffer-stolenmem 设置核显最小被盗内存 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 的话也不需要 framebuffer-fbmem 设置缓冲帧内存大小 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 的话也不需要 AAPL,ig-platform-id Type 解释说明 00001B59 Laptop HD 615, HD 620, HD 630, HD 640 and HD 650 推荐使用 00001659 Laptop 如果 00001B59 无法加速的话，可以尝试一下这个值 0000C087 Laptop 推荐用于 Amber Lake 的 UHD 617 和 Kaby Lake-R 的 UHD 62 00001E59 NUC HD 615 推荐使用 00001B59 NUC HD 630推荐使用 02002659 NUC HD 640/650 推荐使用 如果你的核显为 HD 620 的话呢，一般还需要伪造一下 device-id 值： Key Type Value device-id Data 16590000 所有的 HD 6XX 系列（UHD 没问题），输出会存在一些小问题，可能会导致锁定或者内核崩溃，下面的一些缓冲帧补丁可以考虑一下： framebuffer-con1-enable Data 01000000 framebuffer-con1-alldata Data 01050A00 00080000 87010000 02040A00 00080000 87010000 FF000000 01000000 20000000 其他的一些缓冲帧设置： Key Type Value framebuffer-patch-enable Data 01000000 framebuffer-stolenmem Data 00003001 framebuffer-fbmem Data 00009000 Coffee Lake、Whiskey Lake PciRoot(0x0)/Pci(0x1b,0x0) layout-id AppleALC 音频注入，完整的 ALC ID 可以参考：AppleALC 支持设备列表 PciRoot(0x0)/Pci(0x2,0x0) 配置 iGPU 核显 AAPL,ig-platform-id macOS 用来确定 iGPU 驱动程序如何与我们的系统交互的 device-id 解决一些驱动异常问题，提高兼容度 framebuffer-patch-enable 启用通过 WhateverGreen.kext 进行修补 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 也不需要 framebuffer-stolenmem 设置核显最小被盗内存 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 的话也不需要 framebuffer-fbmem 设置缓冲帧内存大小 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 的话也不需要 AAPL,ig-platform-id Type 解释说明 0900A53E Laptop UHD 630 推荐使用 00009B3E Laptop UHD 620 推荐使用 07009B3E NUC UHD 620/630 推荐使用 0000A53E NUC UHD 655 推荐使用 UHD 630 可以尝试使用以下 device-id 提高稳定性： Key Type Value device-id Data 9B3E0000 Coffee Lake CPU UHD 620 可以尝试使用以下 device-id 提高稳定性： Key Type Value device-id Data 9B3E0000 其他缓冲区设置的参考设置如下： Key Type Value framebuffer-patch-enable Data 01000000 framebuffer-stolenmem Data 00003001 framebuffer-fbmem Data 00009000 Coffee Lake Plus and Comet Lake PciRoot(0x0)/Pci(0x1b,0x0) layout-id AppleALC 音频注入，完整的 ALC ID 可以参考：AppleALC 支持设备列表 PciRoot(0x0)/Pci(0x2,0x0) 配置 iGPU 核显 AAPL,ig-platform-id macOS 用来确定 iGPU 驱动程序如何与我们的系统交互的 device-id 解决一些驱动异常问题，提高兼容度 framebuffer-patch-enable 启用通过 WhateverGreen.kext 进行修补 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 也不需要 framebuffer-stolenmem 设置核显最小被盗内存 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 的话也不需要 framebuffer-fbmem 设置缓冲帧内存大小 如果是独显输出的话可以不需要这个属性 BIOS 可以设置 DVMT Pre-Allocated: 64MB 的话也不需要 AAPL,ig-platform-id Type 解释说明 0900A53E Laptop UHD 630 推荐使用 00009B3E Laptop UHD 620 推荐使用 07009B3E NUC UHD 620/630 推荐使用 0000A53E NUC UHD 655 推荐使用 UHD 630 可以尝试使用以下 device-id 提高稳定性： Key Type Value device-id Data 9B3E0000 Comet Lake CPU UHD 620 可以尝试使用以下 device-id 提高稳定性： Key Type Value device-id Data 9B3E0000 其他缓冲区设置的参考设置如下： Key Type Value framebuffer-patch-enable Data 01000000 framebuffer-stolenmem Data 00003001 framebuffer-fbmem Data 00009000 AMD 桌面平台 因为 AMD CPU 没有核显的原因，所以这些平台无需特殊设置，只需要添加完善声卡信息即可，当然也可以直接通过启动项添加，前期调试的过程中，国光我建议大家是通过启动项添加 alcid=xx 这种形式： PciRoot(0x0)/Pci(0x1b,0x0) layout-id AppleALC 音频注入，完整的 ALC ID 可以参考：[AppleALC 支持设备列表]( powered by Gitbook该文章最后修改时间： 2021-09-20 21:17:27 "},"4-OC配置/4-4.html":{"url":"4-OC配置/4-4.html","title":"4. Kernel","keywords":"","body":"4. Kernel 内核相关的选项设置。 完整的 Quiks 怪癖 因为各个平台的版本不太一样，在详细说明之前写来一个 OC 0.7.3 完整的 Quiks 怪癖 说明，这样心里大家设置的时候心里一般就有个底了。 AppleCpuPmCfgLock 如果你 BIOS 里面 CFG-Lock 已经关闭那么不需要这个 AppleXcpmCfgLock 如果你 BIOS 里面 CFG-Lock 已经关闭那么不需要这个 AppleXcpmExtraMsrs 对没有本机 XCPM 支持的某些 CPU 禁用多个关键 MSR 访问 主要是在无原生电源管理的 CPU上 使用 一般是Haswell-E，Broadwell-E，Skylake-X这三种 CPU 才勾选使用 AppleXcpmForceBoost 强制在 XCPM 模式下实现最大性能 强制拉高睿频 建议在长期高负载的专业设备上使用 某些 Xeon 系列的处理器开启这个选项会受益 CustomSMBIOSGuid 为 UpdatesBiosModeCustom 自定义模式执行 GUID 修补 戴尔笔记本电脑通常要勾选这个 如果你的笔记本无法正常显示序列号的话，也可以勾选试试看 DisableIoMapper 禁用 XNU（VT-d）中的 IOMapper 支持 如果 BIOS 里面禁止了 VT-d，那么就不需要勾选了 DisableLinkeditJettison 此选项允许 Lilu.kext 和可能的其他 kext 在 macOS Big Sur 中以最佳性能级别运行 而不需要在启动项中添加 keepsyms=1，相当于替代掉了他 DisableRtcChecksum 禁用在 AppleRTC 中写入主校验 ExtendBTFeatureFlags 将 FeatureFlags 设置为0x0F，以实现蓝牙的全部功能 ForceSecureBootScheme 强制 x86 方案用于 IMG4 验证 当使用不同于 x86 legacy 的 SecureBootModel 时，虚拟机上需要此选项 IncreasePciBarSize 将 IOPCIFamily 中的 32 位 PCI Bar 大小从 1GBs 增加到 4GBs 需要此选项表示固件配置错误或有缺陷，所以一般也不使用 LapicKernelPanic 禁用由 AP 核心 lapic 中断造成的内核崩溃 用于惠普笔记本的内核奔溃，如果没有奔溃的话就不建议勾选了 LegacyCommpage 将默认的 64 位 commpage bcopy 实现替换为不需要 SSE3 的实现 这对于传统的老平台非常有用 10.4-10.6 新平台基本上不勾选使用 PanicNoKextDump 在发生内核崩溃时阻止输出 Kext 列表, 提供可供排错参考的崩溃日志 排错时的时候建议开启 PowerTimeoutKernelPanic 修复 macOS Catalina 中由于设备电源状态变化超时而导致的内核崩溃 当遇到睡眠不能唤醒，只有重启后才能唤醒的情况下勾选 台式机一般不勾选 ProvideCurrentCpuInfo 向内核提供当前 CPU 信息 SetApfsTrimTimeout 10.14 之前的版本不需要设置 主要针对 SATA SSD，根据不同的主控，设置不同的延迟 ThirdPartyDrives 为 SSD 启用 TRIM 指令，可能会改善休眠情况 NVMe SSD 会自动被 macOS 加载因此不需要 SATA SSD 可以在终端执行 sudo trimforce enable 开启，效果一样 XhciPortLimit 解除 15 个端口限制，确认 USB 端口完美定制的可以不勾选 Intel 桌面平台 Yonah、Conroe、Penryn ProperTree OpenCore Configurator QtOpenCoreConfig Lynnfield、Clarkdale、Sandy Bridge、Ivy Bridge ProperTree CustomSMBIOSGuid：Dell 或者 VIAO 的机器考虑开启 LapicKernelPanic：惠普机器考虑开启 XhciPortLimit：如果你的电脑没有 USB 3.0 的话，不用开启 OpenCore Configurator QtOpenCoreConfig Haswell、Broadwell、Skylake、Kaby Lake、Coffee Lake、Comet Lake ProperTree AppleCpuPmCfgLock：10.10 或者更老的系统需要开启 CustomSMBIOSGuid：Dell 或者 VIAO 的机器考虑开启 LapicKernelPanic：惠普机器考虑开启 XhciPortLimit：解除 15 个端口限制，确认 USB 端口完美定制的可以不勾选 OpenCore Configurator QtOpenCoreConfig Intel 高端桌面平台 Nehalem、Westmere、Sandy and Ivy Bridge-E、Haswell-E、 Broadwell-E ProperTree CustomSMBIOSGuid：Dell 或者 VIAO 的机器考虑开启 LapicKernelPanic：惠普机器考虑开启 XhciPortLimit：解除 15 个端口限制，如果你的电脑没有 USB 3.0 的话，不用开启，或者确认 USB 端口完美定制的话也可以不勾选 OpenCore Configurator QtOpenCoreConfig Skylake-X/W and Cascade Lake-X/W ProperTree CustomSMBIOSGuid：Dell 或者 VIAO 的机器考虑开启 LapicKernelPanic：惠普机器考虑开启 XhciPortLimit：解除 15 个端口限制，如果你的电脑没有 USB 3.0 的话，不用开启，或者确认 USB 端口完美定制的话也可以不勾选 OpenCore Configurator QtOpenCoreConfig Intel 笔记本平台 Clarksfield、Arrandale、Sandy Bridge、Ivy Bridge、 ProperTree CustomSMBIOSGuid：Dell 或者 VIAO 的机器考虑开启 LapicKernelPanic：惠普机器考虑开启 XhciPortLimit：解除 15 个端口限制，如果你的电脑没有 USB 3.0 的话，不用开启，或者确认 USB 端口完美定制的话也可以不勾选 OpenCore Configurator QtOpenCoreConfig Haswell、Broadwell、Skylake、Kaby Lake、Coffee Lake、Whiskey Lake、Coffee Lake Plus、Comet Lake、Icelake ProperTree AppleCpuPmCfgLock：安装 10.10 或者更老的系统需要开启 CustomSMBIOSGuid：Dell 或者 VIAO 的机器考虑开启 LapicKernelPanic：惠普机器考虑开启 XhciPortLimit：解除 15 个端口限制，如果你的电脑没有 USB 3.0 的话，不用开启，或者确认 USB 端口完美定制的话也可以不勾选 OpenCore Configurator QtOpenCoreConfig AMD 桌面平台 Bulldozer(15h)、 Jaguar(16h)、Ryzen、Threadripper(17h and 19h) AMD 平台稍微特殊一点，还需要勾选 DummyPowerManagement，其他的 Quirks 可以参考下图来配置： 除此之外还需要打 Path 补丁，因为属性比较多，建议大家文本方式操作效率更高一点： powered by Gitbook该文章最后修改时间： 2021-09-20 23:48:57 "},"4-OC配置/4-5.html":{"url":"4-OC配置/4-5.html","title":"5. Misc","keywords":"","body":"5. Misc Misc 杂项部分，这部分基本上是通用的，所以国光我很喜欢这一章，这样就不用考虑各个机型了，写起来会比较顺心。 Boot 下面是国光我的使用习惯： Picker Mode：这个选择 External，表示启用外部主题（前提是你拷贝了对应的主题文件） PickerVariant：这里可以手动选择自己想要加载的主题 PollAppleHotKeys： 需要与 Quirk KeySupport=Yes 结合使用, 这个是国光我的个人习惯，表示模拟苹果热键 这样无需在启动项里面添加-v 参数了，直接在选择系统界面 Commad/Ctrl + V 即可，非常简约方便。 快捷键组合: Cmd + V: 启用 -v 跑码 Cmd + Opt + P + R: 重置 NVRAM Cmd + R: 启动恢复分区 Cmd + S: 启动至单用户模式 Option / ALT: 在 ShowPicker 设置成 NO 时显示引导项选择界面, ALT 不可用时可用 ESC 键代替 Cmd + C + 减号: 关闭主板兼容性检查, 等同于添加引导标识符 -no_compat_check Shift: 安全模式 Debug 这个主要用于 Debug 调试使用的，实际上使用默认的也行，下面是 OC 官方建议的设置： 其中 Target 表示： 会每次把启动日志记录到 EFI 分区根目录下，方便调试使用，后期稳定的话可以取消勾选这个「记录到文件」即 Target 的值为 3 Misc 下面也是国光的使用习惯： Scan Policy 可以改为 0，实际上可选的值如下： 有时候安装系统的时候遇到 OC 无法识别 Windows 的启动项的情况，勾选了「允许扫描 EFI 系统分区文件系统」解决了，理论上 Scan Policy 改为 0 也可以解决这类问题。 Valut：Optional 搞错了理论上会直接无法开机，所以基本上相当于是必选项了。 AllowToggle：勾选 这个也是国光我的习惯，勾选这个后，每次开关 SIP 只需要在选择系统界面切换一下即可，很方便： powered by Gitbook该文章最后修改时间： 2021-09-21 00:05:58 "},"4-OC配置/4-6.html":{"url":"4-OC配置/4-6.html","title":"6. NVRAM","keywords":"","body":"6. NVRAM NVRAM 部分，这部分基本上是通用的，所以国光我也很喜欢这一章，这样就不用考虑各个机型了，写起来会比较顺心。 这部分一般主要关注以下 5 个选项。 UIScale UI 缩放 UIScale 有 01 和 02 两个值可选： 01 表示默认缩放 02 表示开启 HiDPi 一般如果搭配的是原生 4k 显示器使用，效果会好一些 如果非 4k 显示器使用脚本强制开启 HiDPi 的话也建议使用，这样开机 Logo 不会大小变 boot-args 启动项 主要设置一些启动项之类的： 常用内核引导标识符合集： 引导标识符 作用 -amd_no_dgpu_accel 关闭 AMD 显卡硬件加速 cpus=# 启用 # 个 CPU 核心 darkwake=0 禁用 Power Nap dart=0 禁用 VT-d debug=0x100 发生 KP 时不自动重启 kext-dev-mode=1 启用 Kext 开发模式, 非开发者请勿使用 -no_compat_check 关闭兼容性检查 -s 单用户模式 slide=# 手动设置 KASLR slide 值为 # -v verbose 跑码模式 -x 安全模式 alcid=x 注入 AppleALC 声卡 ID agdpmod=pikera 5700XT 等高端 A 卡需要配合这个参数，否则可能黑屏 -wegnoegpu 用于禁用除集成 Intel iGPU 之外的所有其他 GPU csr-active-config SIP 相关 系统完整性保护 (SIP) 的设置，一般建议默认就行， 相关值的说明： 00000000 - SIP 完全启用 (0x0)。 03000000 - 禁用 kext 签名 (0x1) 和文件系统保护 (0x2)。 FF030000- 禁用macOS High Sierra 中的所有标志(0x3ff)。 FF070000- 禁用macOS Mojave 中的所有标志在macOS Catalina(0x7ff)，因为 Apple 为可执行策略引入了一个值。 FF0F0000- 禁用 macOS Big Sur (0xfff) 中的所有标志，该标志为经过身份验证的 root提供了另一个新标志 国光我个人建议使用下面这个切换 SIP，这样比较方便高效： prev-lang:kbd 语言设置 这里设置到安装系统的时候的语言： 如果你安装系统发现为俄语的话，那么多半是这里语言设置不对，记得改回对应的语言，改好了要重置下 NVRAM 才可以生效。 常见的语言： 语种 字符串 DATA类型 英语 en-US:0 656e2d55533a30 中文 zh-Hans:0 7A682D48 616E733A 323532 WriteFlash 这个选项也是默认配置就勾选的，表示允许为所添加的变量写入闪存，我们保留默认即可： powered by Gitbook该文章最后修改时间： 2021-09-21 09:16:34 "},"4-OC配置/4-7.html":{"url":"4-OC配置/4-7.html","title":"7. PlatformInfo","keywords":"","body":"7. PlatformInfo 这部分主要介绍的机型相关的信息，可以使用 OCC 这类工具一键生成，选择和自己 CPU 相近的即可，由于 intel CPU 比较冗杂，不确定的话可以去官网搜索一下，确保是同一架构的也可以，这样效率最高也最简单。或者参考 OC 官方的 SMBIOS 选择建议也可以。 QtOpenCoreConfig Opencore Configurator OCC 会自动根据你选择的机型更改 CPU 型号，如果发现你的 CPU 型号错乱的话，那么手动将 ProcessorType 改为 0 就可以了。 AMD 和无核显的 CPU 设置 一般如果你的 CPU 没有核显（F 结尾的）或者你的 CPU 的核显无解（AMD 系列），那么建议设置的最佳机型为 iMac Pro1,1 因为这块的 Mac 机型本身也是没有核显的，所以可以充分利用独显来进行硬解： 你的序列号是否完美？ 因为序列号会影响到 iMessage（短信）的使用，所以要想更接近白苹果的体验的话，得选择一个有效的序列号。苹果官方的序列号查询地址为： https://checkcoverage.apple.com/cn/zh/ 序列号有 3 种级别。 无效序列号 首先最差的就是无效序列号了。 无效序列号 有效但是被用过的序列号 接着就是有效的序列号，但是被人用过了,可能电话技术支持已经到期： 被用过了 电话支持也到期了 也可能是电话技术支持依然有效的： 被用过了 但是电话支持还是有效的 但是并没有什么卵用，这表示这个序列号也被使用过了。 有效且没有被用过的序列号 最完美的序列号，国光我这里尝试了很久很久终于刷到了一次： 这表示序列号存在而且还没有被激活过，看到这种序列号不要犹豫，赶紧冲！ 不过呢，一些老款的机型基本上刷不出这种序列号了，都停产很久了，所以呢这种序列号运气和机遇都得具备才可以刷到。 powered by Gitbook该文章最后修改时间： 2021-09-21 09:33:03 "},"4-OC配置/4-8.html":{"url":"4-OC配置/4-8.html","title":"8. UEFI","keywords":"","body":"8. UEFI 这种 config.list 的最后一章节，姿势有点杂，但是成功就在眼前了，再坚持一下。 嵌入式 APFS 安装 Big Sur 及其以上系统默认就可以了： 如果需要安装 High Sierra(10.13) - Catalina(10.15) 系统的话，需要将 MinDate 和 MinVersion 都设置为 -1 AppleInput 这部分不需要动，全部保持默认即可： 开机音频 基本上默认也行： 国光我习惯将 PlayChime 改为 Disabled，即关闭开机音频，这个开机音频就是白苹果开机那个 Duang 的一声音，还需要选择你的音频设备路径以及打对应的 Drivers 才可以生效，所以还不如直接关掉省心。 UFFI 驱动 这一步就是用于加载我们之前章节放置驱动的部分： 记住要勾选下面的「连接驱动程序」英文名称为：ConnectDrivers Apple 快捷键相关 这一部分一般默认即可： 显示输出 这一部分一般默认即可： 协议覆盖 这一部分一般默认即可： Quiks 怪癖 先来看下怪癖部分，有些平台是需要修改怪癖信息的，不过绝大多数情况下默认就行。 ActivateHpetSupport 老主板比如 ICH6 芯片组不具备相关的 HPET 设置，所以老主板需要开启 EnableVectorAcceleration 在 CPU 支持 avx512 或者 avx 的情况下，在 UEFI 界面中开启 avx 加速 DisableSecurityPolicy 关闭主板的 UEFI 上的 Secure Boot ExitBootServicesDelay 旧主板需要给予主板退出时间（单位为微秒） 较新的主板直接填 0 旧的主板比如 Z87pro，填 3000000-5000000 ForceOcWriteFlash 为所有OpenCore系统变量启用写入闪存一般不勾选 ForgeUefiSupport 勾选时允许在旧版 EFI 1.x 固件（如MacPro5,1）的硬件上运行为UEFI 2.x固件 IgnoreInvalidFlexRatio 如果你没有在 BIOS 中解锁 MSR0x194，即没有解锁 CFG，一定要勾选 ReleaseUsbOwnership 大部分的主板都有自动释放 USB 所有权的功能 如果开机键盘鼠标卡死或者 USB 失灵可以考虑勾选 ReloadOptionRoms 允许在固件版本通过升级后在较旧的 Mac 上重新加载 NVIDIA GOP Option ROM 一般不勾选 RequestBootVarRouting 开启启动磁盘的选项 TscSyncTimeout 帮助一些 X99、X299 的主板开启全核同步功能，但是不如一些 Kexts 专业 此选项旨在代替 TSCAdjustReset.kext 等类似补丁，推荐的值是 500000 但是这并不能在睡眠唤醒后生效，所以请填写默认值 0，并使用 TSCAdjustReset.kext 来做全核同步 UnblockFsConnect 惠普笔记本可能会让 OC 无法扫描到启动项 如果你的笔记本无法识别启动项的话，可以尝试开启 Intel 桌面 - Yonah、Conroe、Penryn、Lynnfield、Clarkdale、Sandy Bridge、Ivy Bridge、Haswell、Broadwell Intel 桌面 - Skylake、Kaby Lake、Coffee Lake、Comet Lake Intel 高端桌面 - Nehalem、Westmere、Sandy and Ivy Bridge-E、Haswell-E、Broadwell-E Intel 高端桌面 - Skylake-X/W、Cascade Lake-X/W Intel 笔记本 - Clarksfield、Arrandale、Sandy Bridge、Ivy Bridge、Haswell、Broadwell Intel 笔记本 - Skylake、Kaby Lake、Coffee Lake、Whiskey Lake、Coffee Lake Plus、Comet Lake、Icelake AMD 桌面系列 powered by Gitbook该文章最后修改时间： 2021-09-21 13:59:24 "},"5-实战演示/":{"url":"5-实战演示/","title":"六、实战演示","keywords":"","body":"六、实战演示 使用的 B360M + i5-8500 的主机来进行实战演示： 1. 机器概览 2. BIOS 设置 3. 磁盘划分 4. 安装 Windows 5. 安装 macOS 6. 完善引导 powered by Gitbook该文章最后修改时间： 2021-09-21 17:36:56 "},"5-实战演示/5-1.html":{"url":"5-实战演示/5-1.html","title":"1. 机器概览","keywords":"","body":"1. 机器概览 有感而发 这台机器是 B 站一位粉丝朋友咸鱼卖我的，他是一个 PHP 程序员，但是失业了，所以比较缺钱，他自己咸鱼上挂主机无人问津，而且考虑到到手刀等不确定因素，所以他联系到了我，想把主机出给我。 起初我并不打算收这个主机的，虽然给我的价格很便宜，只要 1900 元顺丰包邮，但是国光我真的太忙了，根本没有时间鼓捣第二台主机，我日常睡觉都是个问题了，周末在家经常忙的一天只吃 1 顿饭，其他时间随便找点零食吃吃，因为事情真的太多了，女朋友中秋节来我这里玩都没有时间陪她，最后都没有时间送她去车站，临走前还闹得不开心吵了一架，哎，我真的是太难了，另外在字节日常的工作本身就很有挑战性，还得抽出时间写一些用爱发电的教程，总之我一开始真的不想收这个主机，我的事情真的太多太多了。 后面网友依然很真诚，在我拒绝好几次之后，我还是考虑收了。心想这个主机就拿来写一个黑苹果 OC 教程吧，这是我唯一可以想到的用处，搞完教程还可以再水一个驱动效果的演示视频。 做完视频原价再出掉回血，希望我可以出掉这台主机。B 站做视频真的很难，目前我这种小 UP 搞主机这些测评都得自费购买，全新的根本买不起，只能去咸鱼上买了，翻车是常有的事情，而且 B 站的收益很低很低，我上一个驰为的笔记本视频，20w 播放量左右了，收益只有 500 多元，讲真！我自己的一天加班费比这个多好多，而且做这个视频至少也得 1 个多星期，我也不知道我再忙什么？我经常想放弃，自己要不要做些。 另外我经常看到一些伸手党，那种文章也不仔细看，就等着你把饭喂到他嘴巴的这种人： 首先他问的第一个问题，EFI 下载链接我 B站视频简介发了，博客也写了，什么值得买那边甚至也有，但是他就是看不到。 第二个问题，WiFi 的使用情况我特意罗里吧嗦的写文章里面了，但是写了他就是看不到。 第三个问题，我差点没有气死，软件还要我去一个个下载好打包送到他嘴边？ 每当遇到这种人，我想放弃的想法就会越来越强烈，我就会怀疑我做这就事情的意义是啥？这种人值得我去写文章或者制作教程吗？ 总之我是一个很矛盾的人，一方面感觉我没有义务去写这些教程，吃累不讨好。另一方面这个世界需要我的教程！ 机器概览 说了一大堆，但是根本表达不完我此刻内心的想法，算了，继续回到正轨，写文章去了： 配件 型号 CPU i5-8500 显卡 Intel UHD 630 核显 主板 技嘉 360M AORUS Pro 内存 金士顿骇客神条 8GB 2666Mhz * 2 条 硬盘 海康威视 C2000 Pro 512GB 网卡 Fenvi T919 BCM94360CD 四天线版 机箱 乔思伯 T03 电源 爱国者电竞 500W 散热 乔思伯 CR1000 所使用的网卡也是我自费从咸鱼上买的，卖家还认识我，所以给我优惠了一点点。 整机性价比的话不做评价，1 千个人有 1 千个哈姆雷特，性价比在每个人眼中可能也都是不一样的，总之这台机器拿来做黑苹果教程挺合适的，中规中矩是一个比较大众的配置。 powered by Gitbook该文章最后修改时间： 2021-09-21 14:36:32 "},"5-实战演示/5-2.html":{"url":"5-实战演示/5-2.html","title":"2. BIOS 设置","keywords":"","body":"2. BIOS 设置 BIOS 之前的章节已经介绍过了，这里直接列出最终的设置情况吧： 主板型号：GIGABYTE B360M AORUS PRO BIOS 版本：F3 BIOS 日期：2019-05-17 【BIOS 功能】-【Windows 8/10】-【其他操作系统】 【BIOS 功能】-【CSM 支持】-【关闭】 【BIOS 功能】-【安全模式】-【Secure Boot Enable】-【关闭】 【集成外设】-【预设启动的显示设备】-【IGFX】（这里用的核显） 【集成外设】-【Intel Platform Trust Technology (PTT)】-【关闭】 【集成外设】-【Software Guard Extension (SGX)】-【关闭】 【集成外设】-【Trusted Computing】-【Security Device Support】-【Disable】 【集成外设】-【Super IO 配置】-【Serial Port】-【关闭】 【集成外设】-【USB 程序】-【Legacy USB Support】-【开启】 【集成外设】-【集成外设】-【XHCI Hand-off】-【开启】 【集成外设】-【集成外设】-【USB Mass Storege Driver Support】-【开启】 【集成外设】-【Network Stack Configuration】-【Network Stack】-【关闭】 【集成外设】-【SATA And RST Configuration】-【SATA Mode Selection】-【AHCI】 【芯片组】-【VT-d】-【关闭】 【芯片组】-【Internal Graphics】-【启动】 【芯片组】-【DVMT Pre-Allocated】-【64M】 【芯片组】-【DVMT Total Gfx Mem】-【256M】 【芯片组】-【4G 以上解码】-【启动】 【芯片组】-【Wake on LAN Enable】-【关闭】 【电源管理】-【平台电力管理】-【关闭】 【电源管理】-【鼠标唤醒】-【双击】 powered by Gitbook该文章最后修改时间： 2021-09-21 14:56:37 "},"5-实战演示/5-3.html":{"url":"5-实战演示/5-3.html","title":"3. 磁盘划分","keywords":"","body":"3. 磁盘划分 Windows + macOS 这个一个 512GB SSD 双系统磁盘划分的情况： C 盘为未来会用作 Windows 的 C 盘，123 GB 一般也足够日常轻度使用了 D 盘到时候用来安装 macOS，353 GB 日常使用也足够了实际上 E 盘这个盘符是临时划分的，实际上他就是 ESP 引导分区，未来 Windows 和 macOS 的引导都会放这里 macOS 单系统 如果是 macOS 单系统的话，实际上无需进 PE 进行磁盘划分了，安装系统的时候，直接选择整个磁盘就 OK 了。 powered by Gitbook该文章最后修改时间： 2021-09-21 15:12:03 "},"5-实战演示/5-4.html":{"url":"5-实战演示/5-4.html","title":"4. 安装 Windows","keywords":"","body":"4. 安装 Windows 这一章有点多此一举了，正常情况下默认大家都会安装 Windows 的，如果 Windows 都不可以很顺利安装的话，那么黑苹果就难如登天了。 拷贝镜像到 D 盘 这一步不一定是把镜像 D 盘，镜像直接放 U 盘里面然后插电脑上也行，但是理论镜像放在硬盘当中的话，安装速度要快很多。 WinNTSetup 安装系统 基本上各大 Windows PE 里面都自带这个工具，翻译过来也叫 Windows 安装器，认准这个图标就行。 主要操作如下，关键步骤都标注在图片上了： 配置好，点击「安装」就可以了，安装完成后，拔掉 PE U盘，点击「重启」即可： 等待 Windows 初始化 重启根据提示走一遍设置，耐心等待 Windows 10 初始化即可： powered by Gitbook该文章最后修改时间： 2021-09-21 15:37:48 "},"5-实战演示/5-5.html":{"url":"5-实战演示/5-5.html","title":"5. 安装 macOS","keywords":"","body":"5. 安装 macOS 黑苹果 U 盘制作 可以参考之前写的章节：U 盘准备 本机型本次安装所使用的 EFI 我也开源到 Github 了。 项目地址为：https://github.com/sqlsec/GIGABYTE-B360M-AORUS-PRO 设置 U 盘为第一启动 不同的主板不太一样，本次操作的 U 盘启动快捷键为 F12，如果你实在找不到 U 盘启动快捷键的话，直接去 BIOS 将 U 盘改为第一启动项也是可以的： 可以看到我的 U 盘名称为 SMI ZEN-SMI，有两个启动分区，这里一个分区的 Windows PE 一个分区是 OC，因为我们安装需要 OC 了，所以选择 OC 分区即可，不知道哪个分区的可以都试一遍。 OpenCore 界面讲解 进入 OpenCore 界面的主界面如下： 从左到右分别是：Windows PE、硬盘上的 Window 10、安装 macOS 的启动盘、切换 SIP、重置 NVRAM 由于我们的 EFI 是定制好的，直接选择 Install macOS Big Sur 就可以了。 如果你对 EFI 没有信心的话，可以在回车前按下：Command/Windows + V键，这样就进入了 -v 啰嗦模式。 如果你快捷键没有效果的话，说明你的 EFI 没有配置好苹果热键，那么可去 boot-args 启动项里面手动添加 -v 第 1 遍进度条 如果你的 EFI 很完美的话，进度条应该会走的很快： 进入安装系统界面 然后会来到安装系统界面： 如果你的这个界面是俄语的话，那么是你的 EFI NVRAM 部分语言设置不对，可以设置完汉语后，再重置一下 NVRAM 即可。 格式化为苹果的磁盘格式 现在我们打开「磁盘工具」，找到之前留给 macOS 的磁盘分区，选择后点击右上角的「抹掉」： 然后随便写个你喜欢的名称，格式记住要选择「APFS」格式（老的 macOS 系统没有这个格式，就选 HFS 格式）。 格式化成功后的界面如下： 点击「完成」后就可以退出磁盘工具了，找到左上角，点击「磁盘工具」选择「退出磁盘工具」即可退出： 安装 macOS 接着会回到之前的界面，此时选择「安装 macOS Big Sur」，然后点击「继续」： 一直继续，且「同意」苹果的协议，然后选择我们之前格式的苹果格式的磁盘分区「Macintosh」，然后点击「继续」： 接着会开始从 U 盘中拷贝镜像写入到硬盘中： 写入速度根据你的硬盘和 U 盘的速度而定，所以一个高速的 U 盘是可以节约很多时间的。 第 2 遍进度条 上述写入操作的过程会突然重启一下，我们继续选择 OC 分区： 此时的 OC 安装界面稍微不一样了，大概像下面这个样子： 此时我们选择新冒出来的「 macOS Install」，然后会继续走一遍进度条： 和之前不同的是，这个进度条后面会显示安装的剩余时间，我们耐心等待即可。 第 3 遍进度条 上面的进度条走着走着同样也会自动重启，继续选择 U 盘的 OC 分区为第一启动： 此时又回到了这个界面： 我们依然选择「 macOS Install」，然后会继续走一遍进度条，不过这次进度条没有出现倒计时了，就是一个简约的苹果 Logo： 同样这个 Logo 走完也会自动重启。 第 4 遍进度条 自动重启后，继续选择 U 盘的 OC 分区为第一启动： 此时 OC 的界面如下，可以看到我们之前自定义名称的 Mac 格式的硬盘出现了「Macintosh」： 选择「Macintosh」然后回车，这个时候会再走一次进度条： 然后走完进度条之后会自动重启一次。 第 5 遍进度条 自动重启后，继续选择 U 盘的 OC 分区为第一启动： 此时 OC 的界面如下，可以看到我们之前自定义名称的 Mac 格式的硬盘出现了「Macintosh」： 选择「Macintosh」然后回车，这个时候会再走一次进度条，这次进度条不会重启了，顺利的话会进入到苹果的初始化界面。 初始化设置 上面步骤顺利的话会来到苹果的初始化设置界面： 选择好自己的国家地区，然后点击「继续」，接着到了「语言与输入法」界面： 这里都是符合我的需求的，所以继续点击「继续」，接着到了「辅助功能」界面，这些我们可以先不用设置，点击「以后」跳过这一步： 接着到了网络这一步，我们可以选择先不联网，选择「其他网络选项」： 因为正常的电脑联网这一步是需要后续调整的，我这里是因为使用免驱网卡的原因才可以看到 WiFi 的选项，接着选择「我的电脑不接入互联网」： 不联网减少不必要的操作，联网这些操作我们进系统后再设置都是 OK 的。此时应该会弹出提示框，我们忽略警告，选择「继续」操作： 接着到「数据与隐私」部分，选择「继续」： 接着到「迁移助手」界面了，根据自己的情况选择，一般干净安装的话，选择左下角的「以后」： 挖槽，怎么这么多界面，写的好累啊，到了「Apple ID」登录界面，因为我们没有联网，所以选择左下角的「稍后设置」： 然后弹出警告，我们忽略掉，选择「跳过」： 最后同意一下苹果的条款： 设置一些自己的账户和登录密码，选择一下头像然后点击「继续」： 挖槽，太累了不截图了，鸡儿这么多界面，反正一直根据自己的感觉点击就可以了，正常人都没问题的，最后会成功进入系统： 至此，安装就大功告成了！！！ 此刻的你一定很高兴，这个时候丢出打赏链接，效果应该不错的，2333 在这个喧嚣浮躁的时代，坚持写博客输出原创文章的人还有多少呢？写博客感觉一直是用爱发电的状态...... 如果你恰巧财力雄厚，感觉本文对你有所帮助的话，可以考虑打赏一下本文，用以维持高昂的服务器运营费用（域名费用、服务器费用、CDN 费用等） 微信 支付宝 国光我也写了一个打赏页面用以感谢支持我的朋友，详情请看 打赏列表 | 国光 powered by Gitbook该文章最后修改时间： 2021-09-21 16:51:02 "},"5-实战演示/5-6.html":{"url":"5-实战演示/5-6.html","title":"6. 完善引导","keywords":"","body":"6. 完善引导 疑问 聪明的网友肯定会发现：哎，不对啊！我不能每次要进 macOS 系统都得插个 U 盘，然后快捷键启动吧： 2333，当然可以不需要 U 盘了，下面跟着国光的步骤来一步一个脚印的操作。 挂载磁盘引导分区 这一步在 macOS 和 在 Windows 下操作都是可以的。 如果你在 Windows 下操作，一般需要使用 DiskGenius 这个工具来辅助操作，如果是在 macOS 下挂载工具就多了去了了，下面国光使用的 OCC 来进行 EFI 分区的挂载。 首先下载好 OCC 工具，这个工具就算不挂载也是黑苹果必备工具了， OCC 官网下载地址为：https://mackie100projects.altervista.org/download-opencore-configurator/ 打开之后，选择右上角的 OC 图标，点击，找到自己的安装系统的硬盘，点击「挂载分区」： 输入密码后，即可挂载成功，然后点击左上角图标的「打开分区」即可，硬盘的引导分区内容如下： 挂载 U 盘的引导分区 同理，挂载下 U 盘的引导分区，此时 U 盘的引导分区内容如下： 将 OC 文件拷贝到硬盘目录下 任务完成，现在可以拔掉 U 盘，然后关机重启进 Windows 操作系统了。 安装 EasyIUEFI 来到 Windows 下我们可以使用 EasyUEFI 工具来添加引导，当然也有一些替代品如 Bootice，但是呢，这样就篇幅很多，显得很啰嗦了，所以本文只使用 EasyUEFI 做一个演示使用。 EasyUEFI 刚刚出来的时候是免费的，后面慢慢收费了，所以国光这里使用的网上搬运过来的破解版，文件安全与否请自行查杀。 EasyUEFI 破解版下载地址：https://sqlsec.lanzouw.com/iDaQ1ubeg6h 安装与破解不难，先点击「Setup.exe」正常走一遍安装过程，安装完成后先不要打开，把「Crack」目录下的两个文件拷贝到你刚刚选择的安装路径下，确认替换文件即可破解成功： 打开后的主界面如下： 选择「管理 EFI 启动项」，最终效果如下： Windows 添加引导 首先点击「创建新项」： 操作系统类型选择「Linux 或者其他操作系统」，描述随便写一个，目标分区选择「硬盘的第一个 ESP 引导分区」，然后点击「浏览数据」，选择 EFI/OC/ 目录下的 OpenCpre.efi 文化后，点击确定即可： 接着将刚刚添加的启动项，「上移」到第一位即可： 最终的效果 拔掉 U 盘后，每次开机选择操作系统的界面如下： 可以很方便的进入 Windows 和 macOS 系统，至此大功告成了。 此刻的你一定很高兴，这个时候丢出打赏链接，效果应该不错的，2333 在这个喧嚣浮躁的时代，坚持写博客输出原创文章的人还有多少呢？写博客感觉一直是用爱发电的状态...... 如果你恰巧财力雄厚，感觉本文对你有所帮助的话，可以考虑打赏一下本文，用以维持高昂的服务器运营费用（域名费用、服务器费用、CDN 费用等） 微信 支付宝 国光我也写了一个打赏页面用以感谢支持我的朋友，详情请看 打赏列表 | 国光 powered by Gitbook该文章最后修改时间： 2021-09-21 17:24:35 "},"持续更新/":{"url":"持续更新/","title":"持续更新中....","keywords":"","body":"持续更新中.... 由于工作量实在太大了，做了这个教程牺牲了我很多自己的时间，所以短期内不能全部覆盖，后面的黑苹果进阶或者琐碎的知识点也会不定期更新，敬请关注本网站：apple.sqlsec.com 和我 B 站的视频哦，后续教程也会分 P 上传，希望可以让大家都可以很轻松上手黑苹果。 在这个喧嚣浮躁的时代，坚持写博客输出原创文章的人还有多少呢？写博客感觉一直是用爱发电的状态...... 如果你恰巧财力雄厚，感觉本文对你有所帮助的话，可以考虑打赏一下本文，用以维持高昂的服务器运营费用（域名费用、服务器费用、CDN 费用等） 微信 支付宝 国光我也写了一个打赏页面用以感谢支持我的朋友，详情请看 打赏列表 | 国光 powered by Gitbook该文章最后修改时间： 2021-09-21 13:58:58 "}}