module.exports = {
  hooks: {
    'page:before': function(page) {
	  var config = this.config.get('pluginsConfig.valine', {});
      var appId = config.appId;
      var appKey = config.appKey;
	  var placeholder = config.placeholder;
	  var avatar = config.avatar;
	  var meta = config.meta;
	  var pageSize = config.pageSize;
	  var lang = config.lang;
	  var recordIP = config.recordIP;
	  var serverURLs = config.serverURLs;
      var str = '<hr/>'
    + '<div id="vcomments"></div>'
    + '<script src="https://unpkg.com/valine@1.4.16/dist/Valine.min.js"></script>'
	+ '<script src="https://html.sqlsec.com/activate-power-mode.min.js"></script>'
	+ '<script src="https://html.sqlsec.com/clicklove.js"></script>'
	+ '<script>POWERMODE.colorful=!0,POWERMODE.shake=!1,document.body.addEventListener("input",POWERMODE)</script>'
    + '<script>$(document).ready(function () {if(location.href.indexOf("#reloaded")==-1){location.href=location.href+"#reloaded";location.reload();}})</script>'
	+ '<script>'
      + 'new Valine({'
	  + 'el: "#vcomments",'
	  + 'appId: \'' + appId + '\','
	  + 'appKey: \'' + appKey + '\','
	  + 'placeholder: \'' + placeholder + '\','
	  + 'avatar: \'' + avatar + '\','
	  + 'meta: ' + meta + ','
	  + 'pageSize: ' + pageSize + ','
	  + 'lang: \'' + lang + '\','
	  + 'recordIP: ' + recordIP + ''
      + '})'
    + '</script>';
      page.content += str
      return page
    }
  }
};
